<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lecture 3: ChemmineR</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; } /* Keyword */
code > span.dt { color: #dfdfbf; } /* DataType */
code > span.dv { color: #dcdccc; } /* DecVal */
code > span.bn { color: #dca3a3; } /* BaseN */
code > span.fl { color: #c0bed1; } /* Float */
code > span.ch { color: #dca3a3; } /* Char */
code > span.st { color: #cc9393; } /* String */
code > span.co { color: #7f9f7f; } /* Comment */
code > span.ot { color: #efef8f; } /* Other */
code > span.al { color: #ffcfaf; } /* Alert */
code > span.fu { color: #efef8f; } /* Function */
code > span.er { color: #c3bf9f; } /* Error */
code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code > span.sc { color: #dca3a3; } /* SpecialChar */
code > span.vs { color: #cc9393; } /* VerbatimString */
code > span.ss { color: #cc9393; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #f0dfaf; } /* ControlFlow */
code > span.op { color: #f0efd0; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #7f9f7f; } /* Documentation */
code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bioinformatics for Pharmacy</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r-prog.html">Lecture 1: R programming</a>
    </li>
    <li>
      <a href="data-summary.html">Lecture 2: Data summary</a>
    </li>
    <li>
      <a href="prob-and-stat.html">Lecture 2: Probability</a>
    </li>
    <li>
      <a href="func.html">Lecture 3: Functions</a>
    </li>
    <li>
      <a href="cond.html">Lecture 3: Conditioning</a>
    </li>
    <li>
      <a href="chem2.html">Lecture 3: Chemical informatics I</a>
    </li>
    <li>
      <a href="chem.html">Lecture 3: Chemical informatics II</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Lab 1: DNA exercise</a>
    </li>
    <li>
      <a href="lab2.html">Lab 2: Air quality</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://mrrizkallah.github.io/bioscience_r/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lecture 3: ChemmineR</h1>

</div>


<p>Note: the most recent version of this tutorial can be found <a href="https://htmlpreview.github.io/?https://github.com/girke-lab/ChemmineR/blob/master/vignettes/ChemmineR.html">here</a> and a short overview slide show <a href="http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_5_8_2014/Rcheminfo/Cheminfo.pdf">here</a>.</p>
<p><code>ChemmineR</code> is a cheminformatics package for analyzing drug-like small molecule data in R. Its latest version contains functions for efficient processing of large numbers of small molecules, physicochemical/structural property predictions, structural similarity searching, classification and clustering of compound libraries with a wide spectrum of algorithms.</p>
<div id="installation" class="section level2">
<h2>## Installation</h2>
<p>The R software for running ChemmineR can be downloaded from CRAN (<a href="http://cran.at.r-project.org/" class="uri">http://cran.at.r-project.org/</a>). The ChemmineR package can be installed from R with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> if (!<span class="kw">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="dt">quietly=</span><span class="ot">TRUE</span>))
     <span class="kw">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)
 BiocManager::<span class="kw">install</span>(<span class="st">&quot;ChemmineR&quot;</span>)</code></pre></div>
</div>
<div id="loading-the-package-and-documentation" class="section level2">
<h2>Loading the Package and Documentation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">library</span>(<span class="st">&quot;ChemmineR&quot;</span>) <span class="co"># Loads the package</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">library</span>(<span class="dt">help=</span><span class="st">&quot;ChemmineR&quot;</span>) <span class="co"># Lists all functions and classes</span>
 <span class="kw">vignette</span>(<span class="st">&quot;ChemmineR&quot;</span>) <span class="co"># Opens this PDF manual from R</span></code></pre></div>
</div>
<div id="five-minute-tutorial" class="section level2">
<h2>## Five Minute Tutorial</h2>
<p>The following code gives an overview of the most important functionalities provided by <code>ChemmineR</code>. Copy and paste of the commands into the R console will demonstrate their utilities.</p>
<p>Create Instances of <code>SDFset</code> class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(sdfsample)
 sdfset &lt;-<span class="st"> </span>sdfsample
 sdfset <span class="co"># Returns summary of SDFset</span></code></pre></div>
<pre><code>## An instance of &quot;SDFset&quot; with 100 molecules</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfset[<span class="dv">1</span>:<span class="dv">4</span>] <span class="co"># Subsetting of object</span></code></pre></div>
<pre><code>## An instance of &quot;SDFset&quot; with 4 molecules</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfset[[<span class="dv">1</span>]] <span class="co"># Returns summarized content of one SDF</span></code></pre></div>
<pre><code>## An instance of &quot;SDF&quot;
## 
## &lt;&lt;header&gt;&gt;
##                             Molecule_Name                                    Source 
##                                  &quot;650001&quot;                  &quot;  -OEChem-07071010512D&quot; 
##                                   Comment                               Counts_Line 
##                                        &quot;&quot; &quot; 61 64  0     0  0  0  0  0  0999 V2000&quot; 
## 
## &lt;&lt;atomblock&gt;&gt;
##           C1      C2  C3  C5  C6  C7  C8  C9 C10 C11 C12 C13 C14 C15 C16
## O_1   7.0468  0.0839   0   0   0   0   0   0   0   0   0   0   0   0   0
## O_2  12.2708  1.0492   0   0   0   0   0   0   0   0   0   0   0   0   0
## ...      ...     ... ... ... ... ... ... ... ... ... ... ... ... ... ...
## H_60  1.8411 -1.5985   0   0   0   0   0   0   0   0   0   0   0   0   0
## H_61  2.6597 -1.2843   0   0   0   0   0   0   0   0   0   0   0   0   0
## 
## &lt;&lt;bondblock&gt;&gt;
##      C1  C2  C3  C4  C5  C6  C7
## 1     1  16   2   0   0   0   0
## 2     2  23   1   0   0   0   0
## ... ... ... ... ... ... ... ...
## 63   33  60   1   0   0   0   0
## 64   33  61   1   0   0   0   0
## 
## &lt;&lt;datablock&gt;&gt; (33 data items)
##           PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED      PUBCHEM_CACTVS_COMPLEXITY 
##                       &quot;650001&quot;                            &quot;1&quot;                          &quot;700&quot; 
##  PUBCHEM_CACTVS_HBOND_ACCEPTOR                                
##                            &quot;7&quot;                          &quot;...&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">view</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Returns summarized content of many SDFs, not printed here</span>
 <span class="kw">as</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="st">&quot;list&quot;</span>) <span class="co"># Returns complete content of many SDFs, not printed here</span></code></pre></div>
<p>An <code>SDFset</code> is created during the import of an SD file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfset &lt;-<span class="st"> </span><span class="kw">read.SDFset</span>(<span class="st">&quot;http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/sdfsample.sdf&quot;</span>)</code></pre></div>
<p>Miscellaneous accessor methods for <code>SDFset</code> container:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">header</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Not printed here</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">header</span>(sdfset[[<span class="dv">1</span>]])</code></pre></div>
<pre><code>##                             Molecule_Name                                    Source 
##                                  &quot;650001&quot;                  &quot;  -OEChem-07071010512D&quot; 
##                                   Comment                               Counts_Line 
##                                        &quot;&quot; &quot; 61 64  0     0  0  0  0  0  0999 V2000&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">atomblock</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Not printed here</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">atomblock</span>(sdfset[[<span class="dv">1</span>]])[<span class="dv">1</span>:<span class="dv">4</span>,]</code></pre></div>
<pre><code>##          C1     C2 C3 C5 C6 C7 C8 C9 C10 C11 C12 C13 C14 C15 C16
## O_1  7.0468 0.0839  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_2 12.2708 1.0492  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_3 12.2708 3.1186  0  0  0  0  0  0   0   0   0   0   0   0   0
## O_4  7.9128 2.5839  0  0  0  0  0  0   0   0   0   0   0   0   0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bondblock</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Not printed here</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">bondblock</span>(sdfset[[<span class="dv">1</span>]])[<span class="dv">1</span>:<span class="dv">4</span>,]</code></pre></div>
<pre><code>##   C1 C2 C3 C4 C5 C6 C7
## 1  1 16  2  0  0  0  0
## 2  2 23  1  0  0  0  0
## 3  2 27  1  0  0  0  0
## 4  3 25  1  0  0  0  0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">datablock</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Not printed here</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">datablock</span>(sdfset[[<span class="dv">1</span>]])[<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>##           PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED      PUBCHEM_CACTVS_COMPLEXITY 
##                       &quot;650001&quot;                            &quot;1&quot;                          &quot;700&quot; 
##  PUBCHEM_CACTVS_HBOND_ACCEPTOR 
##                            &quot;7&quot;</code></pre>
<p>Assigning compound IDs and keeping them unique:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">cid</span>(sdfset)[<span class="dv">1</span>:<span class="dv">4</span>] <span class="co"># Returns IDs from SDFset object</span></code></pre></div>
<pre><code>## [1] &quot;CMP1&quot; &quot;CMP2&quot; &quot;CMP3&quot; &quot;CMP4&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">sdfid</span>(sdfset)[<span class="dv">1</span>:<span class="dv">4</span>] <span class="co"># Returns IDs from SD file header block</span></code></pre></div>
<pre><code>## [1] &quot;650001&quot; &quot;650002&quot; &quot;650003&quot; &quot;650004&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> unique_ids &lt;-<span class="st"> </span><span class="kw">makeUnique</span>(<span class="kw">sdfid</span>(sdfset))</code></pre></div>
<pre><code>## [1] &quot;No duplicates detected!&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">cid</span>(sdfset) &lt;-<span class="st"> </span>unique_ids</code></pre></div>
<p>Converting the data blocks in an <code>SDFset</code> to a matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> blockmatrix &lt;-<span class="st"> </span><span class="kw">datablock2ma</span>(<span class="dt">datablocklist=</span><span class="kw">datablock</span>(sdfset)) <span class="co"># Converts data block to matrix</span>
 numchar &lt;-<span class="st"> </span><span class="kw">splitNumChar</span>(<span class="dt">blockmatrix=</span>blockmatrix) <span class="co"># Splits to numeric and character matrix</span>
 numchar[[<span class="dv">1</span>]][<span class="dv">1</span>:<span class="dv">2</span>,<span class="dv">1</span>:<span class="dv">2</span>] <span class="co"># Slice of numeric matrix</span></code></pre></div>
<pre><code>##        PUBCHEM_COMPOUND_CID PUBCHEM_COMPOUND_CANONICALIZED
## 650001               650001                              1
## 650002               650002                              1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> numchar[[<span class="dv">2</span>]][<span class="dv">1</span>:<span class="dv">2</span>,<span class="dv">10</span>:<span class="dv">11</span>] <span class="co"># Slice of character matrix</span></code></pre></div>
<pre><code>##        PUBCHEM_MOLECULAR_FORMULA PUBCHEM_OPENEYE_CAN_SMILES                                     
## 650001 &quot;C23H28N4O6&quot;              &quot;CC1=CC(=NO1)NC(=O)CCC(=O)N(CC(=O)NC2CCCC2)C3=CC4=C(C=C3)OCCO4&quot;
## 650002 &quot;C18H23N5O3&quot;              &quot;CN1C2=C(C(=O)NC1=O)N(C(=N2)NCCCO)CCCC3=CC=CC=C3&quot;</code></pre>
<p>Compute atom frequency matrix, molecular weight and formula:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> propma &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">MF=</span><span class="kw">MF</span>(sdfset), <span class="dt">MW=</span><span class="kw">MW</span>(sdfset), <span class="kw">atomcountMA</span>(sdfset))
 propma[<span class="dv">1</span>:<span class="dv">4</span>, ]</code></pre></div>
<pre><code>##                 MF       MW  C  H N O S F Cl
## 650001  C23H28N4O6 456.4916 23 28 4 6 0 0  0
## 650002  C18H23N5O3 357.4069 18 23 5 3 0 0  0
## 650003 C18H18N4O3S 370.4255 18 18 4 3 1 0  0
## 650004 C21H27N5O5S 461.5346 21 27 5 5 1 0  0</code></pre>
<p>Assign matrix data to data block:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">datablock</span>(sdfset) &lt;-<span class="st"> </span>propma
 <span class="kw">datablock</span>(sdfset[<span class="dv">1</span>])</code></pre></div>
<pre><code>## $`650001`
##           MF           MW            C            H            N            O            S 
## &quot;C23H28N4O6&quot;   &quot;456.4916&quot;         &quot;23&quot;         &quot;28&quot;          &quot;4&quot;          &quot;6&quot;          &quot;0&quot; 
##            F           Cl 
##          &quot;0&quot;          &quot;0&quot;</code></pre>
<p>String searching in <code>SDFset</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">grepSDFset</span>(<span class="st">&quot;650001&quot;</span>, sdfset, <span class="dt">field=</span><span class="st">&quot;datablock&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;subset&quot;</span>) <span class="co"># Returns summary view of matches. Not printed here.</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">grepSDFset</span>(<span class="st">&quot;650001&quot;</span>, sdfset, <span class="dt">field=</span><span class="st">&quot;datablock&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;index&quot;</span>)</code></pre></div>
<pre><code>## 1 1 1 1 1 1 1 1 1 
## 1 2 3 4 5 6 7 8 9</code></pre>
<p>Export SDFset to SD file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDF</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>, <span class="dt">sig=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Plot molecule structure of one or many SDFs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">plot</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">print=</span><span class="ot">FALSE</span>) <span class="co"># Plots structures to R graphics device</span></code></pre></div>
<p><img src="chem2_files/figure-html/plotstruct-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">sdf.visualize</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>]) <span class="co"># Compound viewing in web browser</span></code></pre></div>
<div class="figure">
<img src="visualizescreenshot-small.png" alt="Figure: Visualization webpage created by calling sdf.visualize." />
<p class="caption">Figure: Visualization webpage created by calling <code>sdf.visualize</code>.</p>
</div>
<p>Structure similarity searching and clustering:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> apset &lt;-<span class="st"> </span><span class="kw">sdf2ap</span>(sdfset) <span class="co"># Generate atom pair descriptor database for searching</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(apset) <span class="co"># Load sample apset data provided by library.</span>
 <span class="kw">cmp.search</span>(apset, apset[<span class="dv">1</span>], <span class="dt">type=</span><span class="dv">3</span>, <span class="dt">cutoff =</span> <span class="fl">0.3</span>, <span class="dt">quiet=</span><span class="ot">TRUE</span>) <span class="co"># Search apset database with single compound.</span></code></pre></div>
<pre><code>##   index    cid    scores
## 1     1 650001 1.0000000
## 2    96 650102 0.3516643
## 3    67 650072 0.3117569
## 4    88 650094 0.3094629
## 5    15 650015 0.3010753</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">cmp.cluster</span>(<span class="dt">db=</span>apset, <span class="dt">cutoff =</span> <span class="kw">c</span>(<span class="fl">0.65</span>, <span class="fl">0.5</span>), <span class="dt">quiet=</span><span class="ot">TRUE</span>)[<span class="dv">1</span>:<span class="dv">4</span>,] <span class="co"># Binning clustering using variable similarity cutoffs.</span></code></pre></div>
<pre><code>## 
## sorting result...</code></pre>
<pre><code>##       ids CLSZ_0.65 CLID_0.65 CLSZ_0.5 CLID_0.5
## 48 650049         2        48        2       48
## 49 650050         2        48        2       48
## 54 650059         2        54        2       54
## 55 650060         2        54        2       54</code></pre>
</div>
<div id="molecular-structure-data" class="section level2">
<h2>### Molecular Structure Data</h2>
<p>Classes</p>
<ul>
<li><p><code>SDFstr</code>: intermediate string class to facilitate SD file import; not important for end user</p></li>
<li><p><code>SDF</code>: container for single molecule imported from an SD file</p></li>
<li><p><code>SDFset</code>: container for many SDF objects; most important structure container for end user</p></li>
<li><p><code>SMI</code>: container for a single SMILES string</p></li>
<li><p><code>SMIset</code>: container for many SMILES strings</p></li>
</ul>
<p>Functions/Methods (mainly for <code>SDFset</code> container, <code>SMIset</code> should be coerced with <code>smiles2sd</code> to <code>SDFset</code>)</p>
<ul>
<li><p>Accessor methods for <code>SDF/SDFset</code></p>
<ul>
<li><p>Object slots: <code>cid</code>, <code>header</code>, <code>atomblock</code>, <code>bondblock</code>, <code>datablock</code> (<code>sdfid</code>, <code>datablocktag</code>)</p></li>
<li><p>Summary of <code>SDFset</code>: <code>view</code></p></li>
<li><p>Matrix conversion of data block: <code>datablock2ma</code>, <code>splitNumChar</code></p></li>
<li><p>String search in SDFset: <code>grepSDFset</code></p></li>
</ul></li>
<li><p>Coerce one class to another</p>
<ul>
<li>Standard syntax <code>as(..., &quot;...&quot;)</code> works in most cases. For details see R help with <code>?&quot;SDFset-class&quot;</code>.</li>
</ul></li>
<li><p>Utilities</p>
<ul>
<li><p>Atom frequencies: <code>atomcountMA</code>, <code>atomcount</code></p></li>
<li><p>Molecular weight: <code>MW</code></p></li>
<li><p>Molecular formula: <code>MF</code></p></li>
<li><p>...</p></li>
</ul></li>
<li><p>Compound structure depictions</p>
<ul>
<li><p>R graphics device: <code>plot</code>, <code>plotStruc</code></p></li>
<li><p>Online: <code>cmp.visualize</code></p></li>
</ul></li>
</ul>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="structure-descriptor-data" class="section level2">
<h2>Structure Descriptor Data</h2>
<p>Classes</p>
<ul>
<li><p><code>AP</code>: container for atom pair descriptors of a single molecule</p></li>
<li><p><code>APset</code>: container for many AP objects; most important structure descriptor container for end user</p></li>
<li><p><code>FP</code>: container for fingerprint of a single molecule</p></li>
<li><p><code>FPset</code>: container for fingerprints of many molecules, most important structure descriptor container for end user</p></li>
</ul>
<p>Functions/Methods</p>
<ul>
<li><p>Create <code>AP/APset</code> instances</p>
<ul>
<li><p>From <code>SDFset</code>: <code>sdf2ap</code></p></li>
<li><p>From SD file: <code>cmp.parse</code></p></li>
<li><p>Summary of <code>AP/APset</code>: <code>view</code>, <code>db.explain</code></p></li>
</ul></li>
<li><p>Accessor methods for AP/APset</p>
<ul>
<li>Object slots: <code>ap</code>, <code>cid</code></li>
</ul></li>
<li><p>Coerce one class to another</p>
<ul>
<li>Standard syntax <code>as(..., &quot;...&quot;)</code> works in most cases. For details see R help with <code>?&quot;APset-class&quot;</code>.</li>
</ul></li>
<li><p>Structure Similarity comparisons and Searching</p>
<ul>
<li><p>Compute pairwise similarities : <code>cmp.similarity</code>, <code>fpSim</code></p></li>
<li><p>Search APset database: <code>cmp.search</code>, <code>fpSim</code></p></li>
</ul></li>
<li><p>AP-based Structure Similarity Clustering</p>
<ul>
<li><p>Single-linkage binning clustering: <code>cmp.cluster</code></p></li>
<li><p>Visualize clustering result with MDS: <code>cluster.visualize</code></p></li>
<li>Size distribution of clusters: <code>cluster.sizestat</code></li>
</ul></li>
<li>Folding
<ul>
<li>Fold a descriptor with <code>fold</code></li>
<li>Query the number of times a descriptor has been folded: <code>foldCount</code></li>
<li>Query the number of bits in a descriptor: <code>numBits</code></li>
</ul></li>
</ul>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="import-of-compounds" class="section level1">
<h1>Import of Compounds</h1>
<div id="sdf-import" class="section level2">
<h2>SDF Import</h2>
<p>The following gives an overview of the most important import/export functionalities for small molecules provided by <code>ChemmineR</code>. The given example creates an instance of the <code>SDFset</code> class using as sample data set the first 100 compounds from this PubChem SD file (SDF): Compound_00650001_00675000.sdf.gz (<a href="ftp://ftp.ncbi.nih.gov/pubchem/Compound/CURRENT-Full/SDF/" class="uri">ftp://ftp.ncbi.nih.gov/pubchem/Compound/CURRENT-Full/SDF/</a>).</p>
<p>SDFs can be imported with the <code>read.SDFset</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfset &lt;-<span class="st"> </span><span class="kw">read.SDFset</span>(<span class="st">&quot;http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/sdfsample.sdf&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(sdfsample) <span class="co"># Loads the same SDFset provided by the library</span>
 sdfset &lt;-<span class="st"> </span>sdfsample
 valid &lt;-<span class="st"> </span><span class="kw">validSDF</span>(sdfset) <span class="co"># Identifies invalid SDFs in SDFset objects</span>
 sdfset &lt;-<span class="st"> </span>sdfset[valid] <span class="co"># Removes invalid SDFs, if there are any</span></code></pre></div>
<p>Import SD file into <code>SDFstr</code> container:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfstr &lt;-<span class="st"> </span><span class="kw">read.SDFstr</span>(<span class="st">&quot;http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/sdfsample.sdf&quot;</span>)</code></pre></div>
<p>Create <code>SDFset</code> from <code>SDFstr</code> class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfstr &lt;-<span class="st"> </span><span class="kw">as</span>(sdfset, <span class="st">&quot;SDFstr&quot;</span>)
 sdfstr</code></pre></div>
<pre><code>## An instance of &quot;SDFstr&quot; with 100 molecules</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">as</span>(sdfstr, <span class="st">&quot;SDFset&quot;</span>)</code></pre></div>
<pre><code>## An instance of &quot;SDFset&quot; with 100 molecules</code></pre>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="smiles-import" class="section level2">
<h2>SMILES Import</h2>
<p>The <code>read.SMIset</code> function imports one or many molecules from a SMILES file and stores them in a <code>SMIset</code> container. The input file is expected to contain one SMILES string per row with tab-separated compound identifiers at the end of each line. The compound identifiers are optional.</p>
<p>Create sample SMILES file and then import it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(smisample); smiset &lt;-<span class="st"> </span>smisample
 <span class="kw">write.SMI</span>(smiset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.smi&quot;</span>)
 smiset &lt;-<span class="st"> </span><span class="kw">read.SMIset</span>(<span class="st">&quot;sub.smi&quot;</span>)</code></pre></div>
<p>Inspect content of <code>SMIset</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(smisample) <span class="co"># Loads the same SMIset provided by the library</span>
 smiset &lt;-<span class="st"> </span>smisample
 smiset</code></pre></div>
<pre><code>## An instance of &quot;SMIset&quot; with 100 molecules</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">view</span>(smiset[<span class="dv">1</span>:<span class="dv">2</span>])</code></pre></div>
<pre><code>## $`650001`
## An instance of &quot;SMI&quot;
## [1] &quot;O=C(NC1CCCC1)CN(c1cc2OCCOc2cc1)C(=O)CCC(=O)Nc1noc(c1)C&quot;
## 
## $`650002`
## An instance of &quot;SMI&quot;
## [1] &quot;O=c1[nH]c(=O)n(c2nc(n(CCCc3ccccc3)c12)NCCCO)C&quot;</code></pre>
<p>Accessor functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">cid</span>(smiset[<span class="dv">1</span>:<span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] &quot;650001&quot; &quot;650002&quot; &quot;650003&quot; &quot;650004&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> smi &lt;-<span class="st"> </span><span class="kw">as.character</span>(smiset[<span class="dv">1</span>:<span class="dv">2</span>])</code></pre></div>
<p>Create <code>SMIset</code> from named character vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">as</span>(smi, <span class="st">&quot;SMIset&quot;</span>)</code></pre></div>
<pre><code>## An instance of &quot;SMIset&quot; with 2 molecules</code></pre>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
</div>
<div id="export-of-compounds" class="section level1">
<h1>Export of Compounds</h1>
<div id="sdf-export" class="section level2">
<h2>SDF Export</h2>
<p>Write objects of classes <code>SDFset/SDFstr/SDF</code> to SD file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDF</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>)</code></pre></div>
<p>Writing customized <code>SDFset</code> to file containing <code>ChemmineR</code> signature, IDs from <code>SDFset</code> and no data block:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDF</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>, <span class="dt">sig=</span><span class="ot">TRUE</span>, <span class="dt">cid=</span><span class="ot">TRUE</span>, <span class="dt">db=</span><span class="ot">NULL</span>)</code></pre></div>
<p>Example for injecting a custom matrix/data frame into the data block of an <code>SDFset</code> and then writing it to an SD file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> props &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">MF=</span><span class="kw">MF</span>(sdfset), <span class="dt">MW=</span><span class="kw">MW</span>(sdfset), <span class="kw">atomcountMA</span>(sdfset))
 <span class="kw">datablock</span>(sdfset) &lt;-<span class="st"> </span>props
 <span class="kw">write.SDF</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>, <span class="dt">sig=</span><span class="ot">TRUE</span>, <span class="dt">cid=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Indirect export via <code>SDFstr</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">sdf2str</span>(<span class="dt">sdf=</span>sdfset[[<span class="dv">1</span>]], <span class="dt">sig=</span><span class="ot">TRUE</span>, <span class="dt">cid=</span><span class="ot">TRUE</span>) <span class="co"># Uses default components</span>
 <span class="kw">sdf2str</span>(<span class="dt">sdf=</span>sdfset[[<span class="dv">1</span>]], <span class="dt">head=</span>letters[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">db=</span><span class="ot">NULL</span>) <span class="co"># Uses custom components for header and data block</span></code></pre></div>
<p>Write <code>SDF</code>, <code>SDFset</code> or <code>SDFstr</code> classes to file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDF</span>(sdfset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>, <span class="dt">sig=</span><span class="ot">TRUE</span>, <span class="dt">cid=</span><span class="ot">TRUE</span>, <span class="dt">db=</span><span class="ot">NULL</span>)
 <span class="kw">write.SDF</span>(sdfstr[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>)
 <span class="kw">cat</span>(<span class="kw">unlist</span>(<span class="kw">as</span>(sdfstr[<span class="dv">1</span>:<span class="dv">4</span>], <span class="st">&quot;list&quot;</span>)), <span class="dt">file=</span><span class="st">&quot;sub.sdf&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</code></pre></div>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="smiles-export" class="section level2">
<h2>SMILES Export</h2>
<p>Write objects of class <code>SMIset</code> to SMILES file with and without compound identifiers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(smisample); smiset &lt;-<span class="st"> </span>smisample <span class="co"># Sample data set</span>

 <span class="kw">write.SMI</span>(smiset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.smi&quot;</span>, <span class="dt">cid=</span><span class="ot">TRUE</span>) <span class="kw">write.SMI</span>(smiset[<span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">file=</span><span class="st">&quot;sub.smi&quot;</span>, <span class="dt">cid=</span><span class="ot">FALSE</span>)</code></pre></div>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
</div>
<div id="format-interconversions" class="section level1">
<h1>Format Interconversions</h1>
<p>The <code>sdf2smiles</code> and <code>smiles2sdf</code> functions provide format interconversion between SMILES strings (Simplified Molecular Input Line Entry Specification) and <code>SDFset</code> containers.</p>
<p>Convert an <code>SDFset</code> container to a SMILES <code>character</code> string:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(sdfsample);
 sdfset &lt;-<span class="st"> </span>sdfsample[<span class="dv">1</span>]
 smiles &lt;-<span class="st"> </span><span class="kw">sdf2smiles</span>(sdfset)
 smiles</code></pre></div>
<p>Convert a SMILES <code>character</code> string to an <code>SDFset</code> container:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdf &lt;-<span class="st"> </span><span class="kw">smiles2sdf</span>(<span class="st">&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</span>)
 <span class="kw">view</span>(sdf)</code></pre></div>
<p>When the <code>ChemineOB</code> package is installed these conversions are performed with the OpenBabel Open Source Chemistry Toolbox. Otherwise the functions will fall back to using the ChemMine Tools web service for this operation. The latter will require internet connectivity and is limited to only the first compound given. <code>ChemmineOB</code> provides access to the compound format conversion functions of OpenBabel. Currently, over 160 formats are supported by OpenBabel. The functions <code>convertFormat</code> and <code>convertFormatFile</code> can be used to convert files or strings between any two formats supported by OpenBabel. For example, to convert a SMILES string to an SDF string, one can use the <code>convertFormat</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfStr &lt;-<span class="st"> </span><span class="kw">convertFormat</span>(<span class="st">&quot;SMI&quot;</span>,<span class="st">&quot;SDF&quot;</span>,<span class="st">&quot;CC(=O)OC1=CC=CC=C1C(=O)O_name&quot;</span>)</code></pre></div>
<p>This will return the given compound as an SDF formatted string. 2D coordinates are also computed and included in the resulting SDF string.</p>
<p>To convert a file with compounds encoded in one format to another format, the <code>convertFormatFile</code> function can be used instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">convertFormatFile</span>(<span class="st">&quot;SMI&quot;</span>,<span class="st">&quot;SDF&quot;</span>,<span class="st">&quot;test.smiles&quot;</span>,<span class="st">&quot;test.sdf&quot;</span>)</code></pre></div>
<p>To see the whole list of file formats supported by OpenBabel, one can run from the command-line &quot;obabel -L formats&quot;.</p>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="splitting-sd-files" class="section level1">
<h1>Splitting SD Files</h1>
<p>The following <code>write.SDFsplit</code> function allows to split SD Files into any number of smaller SD Files. This can become important when working with very big SD Files. Users should note that this function can output many files, thus one should run it in a dedicated directory!</p>
<p>Create sample SD File with 100 molecules:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDF</span>(sdfset, <span class="st">&quot;test.sdf&quot;</span>)</code></pre></div>
<p>Read in sample SD File. Note: reading file into SDFstr is much faster than into SDFset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> sdfstr &lt;-<span class="st"> </span><span class="kw">read.SDFstr</span>(<span class="st">&quot;test.sdf&quot;</span>)</code></pre></div>
<p>Run export on <code>SDFstr</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDFsplit</span>(<span class="dt">x=</span>sdfstr, <span class="dt">filetag=</span><span class="st">&quot;myfile&quot;</span>, <span class="dt">nmol=</span><span class="dv">10</span>) <span class="co"># &#39;nmol&#39; defines the number of molecules to write to each file</span></code></pre></div>
<p>Run export on <code>SDFset</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">write.SDFsplit</span>(<span class="dt">x=</span>sdfset, <span class="dt">filetag=</span><span class="st">&quot;myfile&quot;</span>, <span class="dt">nmol=</span><span class="dv">10</span>)</code></pre></div>
</div>
<div id="searching-pubchem" class="section level1">
<h1>Searching PubChem</h1>
<div id="get-compounds-from-pubchem-by-id" class="section level2">
<h2>Get Compounds from PubChem by Id</h2>
<p>The function <code>getIds</code> accepts one or more numeric PubChem compound ids and downloads the corresponding compounds from PubChem Power User Gateway (PUG) returning results in an <code>SDFset</code> container. The ChemMine Tools web service is used as an intermediate, to translate queries from plain HTTP POST to a PUG SOAP query.</p>
<p>Fetch 2 compounds from PubChem:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> compounds &lt;-<span class="st"> </span><span class="kw">getIds</span>(<span class="kw">c</span>(<span class="dv">111</span>,<span class="dv">123</span>))
 compounds</code></pre></div>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="search-a-smiles-query-in-pubchem" class="section level2">
<h2>Search a SMILES Query in PubChem</h2>
<p>The function <code>searchString</code> accepts one SMILES string (Simplified Molecular Input Line Entry Specification) and performs a &gt;0.95 similarity PubChem fingerprint search, returning the hits in an <code>SDFset</code> container. The ChemMine Tools web service is used as an intermediate, to translate queries from plain HTTP POST to a PubChem Power User Gateway (PUG) query.</p>
<p>Search a SMILES string on PubChem:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> compounds &lt;-<span class="st"> </span><span class="kw">searchString</span>(<span class="st">&quot;CC(=O)OC1=CC=CC=C1C(=O)O&quot;</span>) compounds</code></pre></div>
<div align="right">
<a href="">Back to Table of Contents</a>
</div>
</div>
<div id="search-an-sdf-query-in-pubchem" class="section level2">
<h2>Search an SDF Query in PubChem</h2>
<p>The function <code>searchSim</code> performs a PubChem similarity search just like <code>searchString</code>, but accepts a query in an <code>SDFset</code> container. If the query contains more than one compound, only the first is searched.</p>
<p>Search an <code>SDFset</code> container on PubChem:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">data</span>(sdfsample);
 sdfset &lt;-<span class="st"> </span>sdfsample[<span class="dv">1</span>]
 compounds &lt;-<span class="st"> </span><span class="kw">searchSim</span>(sdfset)
 compounds</code></pre></div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTGVjdHVyZSAzOiBDaGVtbWluZVIiCi0tLQoKCmBgYHtyIHN0eWxlLCBlY2hvID0gRkFMU0UsIHJlc3VsdHMgPSAnYXNpcyd9Cm9wdGlvbnMod2lkdGg9MTAwLCBtYXgucHJpbnQ9MTAwMCkKa25pdHI6Om9wdHNfY2h1bmskc2V0KAogICAgZXZhbD1hcy5sb2dpY2FsKFN5cy5nZXRlbnYoIktOSVRSX0VWQUwiLCAiVFJVRSIpKSwKICAgIGNhY2hlPWFzLmxvZ2ljYWwoU3lzLmdldGVudigiS05JVFJfQ0FDSEUiLCAiVFJVRSIpKSkKYGBgCgpgYGB7ciBzZXR1cCwgZWNobz1GQUxTRSwgbWVzc2FnZXM9RkFMU0UsIHdhcm5pbmdzPUZBTFNFfQpzdXBwcmVzc1BhY2thZ2VTdGFydHVwTWVzc2FnZXMoewogICAgbGlicmFyeShDaGVtbWluZVIpCiAgICBsaWJyYXJ5KGZtY3NSKQogICAgbGlicmFyeShnZ3Bsb3QyKQoJICNsaWJyYXJ5KENoZW1taW5lT0IpCn0pCmBgYAoKTm90ZTogdGhlIG1vc3QgcmVjZW50IHZlcnNpb24gb2YgdGhpcyB0dXRvcmlhbCBjYW4gYmUgZm91bmQgPGEgaHJlZj0iaHR0cHM6Ly9odG1scHJldmlldy5naXRodWIuaW8vP2h0dHBzOi8vZ2l0aHViLmNvbS9naXJrZS1sYWIvQ2hlbW1pbmVSL2Jsb2IvbWFzdGVyL3ZpZ25ldHRlcy9DaGVtbWluZVIuaHRtbCI+aGVyZTwvYT4gYW5kIGEgc2hvcnQgb3ZlcnZpZXcgc2xpZGUgc2hvdyBbaGVyZV0oaHR0cDovL2ZhY3VsdHkudWNyLmVkdS9+dGdpcmtlL0hUTUxfUHJlc2VudGF0aW9ucy9NYW51YWxzL1dvcmtzaG9wX0RlY181XzhfMjAxNC9SY2hlbWluZm8vQ2hlbWluZm8ucGRmKS4KCgpgQ2hlbW1pbmVSYCBpcyBhIGNoZW1pbmZvcm1hdGljcyBwYWNrYWdlIGZvciBhbmFseXppbmcKZHJ1Zy1saWtlIHNtYWxsIG1vbGVjdWxlIGRhdGEgaW4gUi4gSXRzIGxhdGVzdCB2ZXJzaW9uIGNvbnRhaW5zCmZ1bmN0aW9ucyBmb3IgZWZmaWNpZW50IHByb2Nlc3Npbmcgb2YgbGFyZ2UgbnVtYmVycyBvZiBzbWFsbCBtb2xlY3VsZXMsCnBoeXNpY29jaGVtaWNhbC9zdHJ1Y3R1cmFsIHByb3BlcnR5IHByZWRpY3Rpb25zLCBzdHJ1Y3R1cmFsIHNpbWlsYXJpdHkKc2VhcmNoaW5nLCBjbGFzc2lmaWNhdGlvbiBhbmQgY2x1c3RlcmluZyBvZiBjb21wb3VuZCBsaWJyYXJpZXMgd2l0aCBhCndpZGUgc3BlY3RydW0gb2YgYWxnb3JpdGhtcy4KCgojIyBJbnN0YWxsYXRpb24KLS0tLS0tLS0tLS0tCgpUaGUgUiBzb2Z0d2FyZSBmb3IgcnVubmluZyBDaGVtbWluZVIgY2FuIGJlIGRvd25sb2FkZWQgZnJvbSBDUkFOCig8aHR0cDovL2NyYW4uYXQuci1wcm9qZWN0Lm9yZy8+KS4gVGhlIENoZW1taW5lUiBwYWNrYWdlIGNhbiBiZQppbnN0YWxsZWQgZnJvbSBSIHdpdGg6CgpgYGB7ciBldmFsPUZBTFNFfQogaWYgKCFyZXF1aXJlTmFtZXNwYWNlKCJCaW9jTWFuYWdlciIsIHF1aWV0bHk9VFJVRSkpCiAgICAgaW5zdGFsbC5wYWNrYWdlcygiQmlvY01hbmFnZXIiKQogQmlvY01hbmFnZXI6Omluc3RhbGwoIkNoZW1taW5lUiIpCmBgYAoKTG9hZGluZyB0aGUgUGFja2FnZSBhbmQgRG9jdW1lbnRhdGlvbgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogbGlicmFyeSgiQ2hlbW1pbmVSIikgIyBMb2FkcyB0aGUgcGFja2FnZQpgYGAKCmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiBsaWJyYXJ5KGhlbHA9IkNoZW1taW5lUiIpICMgTGlzdHMgYWxsIGZ1bmN0aW9ucyBhbmQgY2xhc3NlcwogdmlnbmV0dGUoIkNoZW1taW5lUiIpICMgT3BlbnMgdGhpcyBQREYgbWFudWFsIGZyb20gUgpgYGAKCgojIyBGaXZlIE1pbnV0ZSBUdXRvcmlhbAotLS0tLS0tLS0tLS0tLS0tLS0tLQoKVGhlIGZvbGxvd2luZyBjb2RlIGdpdmVzIGFuIG92ZXJ2aWV3IG9mIHRoZSBtb3N0IGltcG9ydGFudApmdW5jdGlvbmFsaXRpZXMgcHJvdmlkZWQgYnkgYENoZW1taW5lUmAuIENvcHkgYW5kIHBhc3RlCm9mIHRoZSBjb21tYW5kcyBpbnRvIHRoZSBSIGNvbnNvbGUgd2lsbCBkZW1vbnN0cmF0ZSB0aGVpciB1dGlsaXRpZXMuCgpDcmVhdGUgSW5zdGFuY2VzIG9mIGBTREZzZXRgIGNsYXNzOgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBkYXRhKHNkZnNhbXBsZSkKIHNkZnNldCA8LSBzZGZzYW1wbGUKIHNkZnNldCAjIFJldHVybnMgc3VtbWFyeSBvZiBTREZzZXQKIHNkZnNldFsxOjRdICMgU3Vic2V0dGluZyBvZiBvYmplY3QKCiBzZGZzZXRbWzFdXSAjIFJldHVybnMgc3VtbWFyaXplZCBjb250ZW50IG9mIG9uZSBTREYKCgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogdmlldyhzZGZzZXRbMTo0XSkgIyBSZXR1cm5zIHN1bW1hcml6ZWQgY29udGVudCBvZiBtYW55IFNERnMsIG5vdCBwcmludGVkIGhlcmUKIGFzKHNkZnNldFsxOjRdLCAibGlzdCIpICMgUmV0dXJucyBjb21wbGV0ZSBjb250ZW50IG9mIG1hbnkgU0RGcywgbm90IHByaW50ZWQgaGVyZQoKYGBgCgoKQW4gYFNERnNldGAgaXMgY3JlYXRlZCBkdXJpbmcgdGhlIGltcG9ydCBvZiBhbiBTRCBmaWxlOgoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHNkZnNldCA8LSByZWFkLlNERnNldCgiaHR0cDovL2ZhY3VsdHkudWNyLmVkdS9+dGdpcmtlL0RvY3VtZW50cy9SX0Jpb0NvbmQvU2FtcGxlcy9zZGZzYW1wbGUuc2RmIikKYGBgCgoKTWlzY2VsbGFuZW91cyBhY2Nlc3NvciBtZXRob2RzIGZvciBgU0RGc2V0YCBjb250YWluZXI6CgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogaGVhZGVyKHNkZnNldFsxOjRdKSAjIE5vdCBwcmludGVkIGhlcmUKYGBgCgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBoZWFkZXIoc2Rmc2V0W1sxXV0pCmBgYAoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIGF0b21ibG9jayhzZGZzZXRbMTo0XSkgIyBOb3QgcHJpbnRlZCBoZXJlCmBgYAoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQphdG9tYmxvY2soc2Rmc2V0W1sxXV0pWzE6NCxdCmBgYAoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KYm9uZGJsb2NrKHNkZnNldFsxOjRdKSAjIE5vdCBwcmludGVkIGhlcmUKYGBgCgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBib25kYmxvY2soc2Rmc2V0W1sxXV0pWzE6NCxdCmBgYApgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogZGF0YWJsb2NrKHNkZnNldFsxOjRdKSAjIE5vdCBwcmludGVkIGhlcmUKYGBgCgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBkYXRhYmxvY2soc2Rmc2V0W1sxXV0pWzE6NF0KYGBgCgoKQXNzaWduaW5nIGNvbXBvdW5kIElEcyBhbmQga2VlcGluZyB0aGVtIHVuaXF1ZToKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogY2lkKHNkZnNldClbMTo0XSAjIFJldHVybnMgSURzIGZyb20gU0RGc2V0IG9iamVjdAogc2RmaWQoc2Rmc2V0KVsxOjRdICMgUmV0dXJucyBJRHMgZnJvbSBTRCBmaWxlIGhlYWRlciBibG9jawogdW5pcXVlX2lkcyA8LSBtYWtlVW5pcXVlKHNkZmlkKHNkZnNldCkpCiBjaWQoc2Rmc2V0KSA8LSB1bmlxdWVfaWRzCmBgYAoKCkNvbnZlcnRpbmcgdGhlIGRhdGEgYmxvY2tzIGluIGFuIGBTREZzZXRgIHRvIGEgbWF0cml4OgoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogYmxvY2ttYXRyaXggPC0gZGF0YWJsb2NrMm1hKGRhdGFibG9ja2xpc3Q9ZGF0YWJsb2NrKHNkZnNldCkpICMgQ29udmVydHMgZGF0YSBibG9jayB0byBtYXRyaXgKIG51bWNoYXIgPC0gc3BsaXROdW1DaGFyKGJsb2NrbWF0cml4PWJsb2NrbWF0cml4KSAjIFNwbGl0cyB0byBudW1lcmljIGFuZCBjaGFyYWN0ZXIgbWF0cml4CiBudW1jaGFyW1sxXV1bMToyLDE6Ml0gIyBTbGljZSBvZiBudW1lcmljIG1hdHJpeAogbnVtY2hhcltbMl1dWzE6MiwxMDoxMV0gIyBTbGljZSBvZiBjaGFyYWN0ZXIgbWF0cml4CmBgYAoKCkNvbXB1dGUgYXRvbSBmcmVxdWVuY3kgbWF0cml4LCBtb2xlY3VsYXIgd2VpZ2h0IGFuZCBmb3JtdWxhOgoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogcHJvcG1hIDwtIGRhdGEuZnJhbWUoTUY9TUYoc2Rmc2V0KSwgTVc9TVcoc2Rmc2V0KSwgYXRvbWNvdW50TUEoc2Rmc2V0KSkKIHByb3BtYVsxOjQsIF0KYGBgCgoKQXNzaWduIG1hdHJpeCBkYXRhIHRvIGRhdGEgYmxvY2s6CmBgYHtyIGV2YWw9VFJVRSwgdGlkeT1GQUxTRX0KIGRhdGFibG9jayhzZGZzZXQpIDwtIHByb3BtYQogZGF0YWJsb2NrKHNkZnNldFsxXSkKYGBgCgoKU3RyaW5nIHNlYXJjaGluZyBpbiBgU0RGc2V0YDoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIGdyZXBTREZzZXQoIjY1MDAwMSIsIHNkZnNldCwgZmllbGQ9ImRhdGFibG9jayIsIG1vZGU9InN1YnNldCIpICMgUmV0dXJucyBzdW1tYXJ5IHZpZXcgb2YgbWF0Y2hlcy4gTm90IHByaW50ZWQgaGVyZS4KYGBgCgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBncmVwU0RGc2V0KCI2NTAwMDEiLCBzZGZzZXQsIGZpZWxkPSJkYXRhYmxvY2siLCBtb2RlPSJpbmRleCIpCmBgYAoKCkV4cG9ydCBTREZzZXQgdG8gU0QgZmlsZToKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHdyaXRlLlNERihzZGZzZXRbMTo0XSwgZmlsZT0ic3ViLnNkZiIsIHNpZz1UUlVFKQpgYGAKCgpQbG90IG1vbGVjdWxlIHN0cnVjdHVyZSBvZiBvbmUgb3IgbWFueSBTREZzOgpgYGB7ciBwbG90c3RydWN0LCBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBwbG90KHNkZnNldFsxOjRdLCBwcmludD1GQUxTRSkgIyBQbG90cyBzdHJ1Y3R1cmVzIHRvIFIgZ3JhcGhpY3MgZGV2aWNlCmBgYAoKCgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogc2RmLnZpc3VhbGl6ZShzZGZzZXRbMTo0XSkgIyBDb21wb3VuZCB2aWV3aW5nIGluIHdlYiBicm93c2VyCmBgYAoKIVtGaWd1cmU6IFZpc3VhbGl6YXRpb24gd2VicGFnZSBjcmVhdGVkIGJ5IGNhbGxpbmcKYHNkZi52aXN1YWxpemVgLl0odmlzdWFsaXplc2NyZWVuc2hvdC1zbWFsbC5wbmcgKQoKU3RydWN0dXJlIHNpbWlsYXJpdHkgc2VhcmNoaW5nIGFuZCBjbHVzdGVyaW5nOgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogYXBzZXQgPC0gc2RmMmFwKHNkZnNldCkgIyBHZW5lcmF0ZSBhdG9tIHBhaXIgZGVzY3JpcHRvciBkYXRhYmFzZSBmb3Igc2VhcmNoaW5nCmBgYAoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogZGF0YShhcHNldCkgIyBMb2FkIHNhbXBsZSBhcHNldCBkYXRhIHByb3ZpZGVkIGJ5IGxpYnJhcnkuCiBjbXAuc2VhcmNoKGFwc2V0LCBhcHNldFsxXSwgdHlwZT0zLCBjdXRvZmYgPSAwLjMsIHF1aWV0PVRSVUUpICMgU2VhcmNoIGFwc2V0IGRhdGFiYXNlIHdpdGggc2luZ2xlIGNvbXBvdW5kLgoKIGNtcC5jbHVzdGVyKGRiPWFwc2V0LCBjdXRvZmYgPSBjKDAuNjUsIDAuNSksIHF1aWV0PVRSVUUpWzE6NCxdICMgQmlubmluZyBjbHVzdGVyaW5nIHVzaW5nIHZhcmlhYmxlIHNpbWlsYXJpdHkgY3V0b2Zmcy4KYGBgCgoKIyMjIE1vbGVjdWxhciBTdHJ1Y3R1cmUgRGF0YQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCkNsYXNzZXMKCi0gICBgU0RGc3RyYDogaW50ZXJtZWRpYXRlIHN0cmluZyBjbGFzcyB0byBmYWNpbGl0YXRlIFNECiAgICBmaWxlIGltcG9ydDsgbm90IGltcG9ydGFudCBmb3IgZW5kIHVzZXIKCi0gICBgU0RGYDogY29udGFpbmVyIGZvciBzaW5nbGUgbW9sZWN1bGUgaW1wb3J0ZWQgZnJvbSBhbgogICAgU0QgZmlsZQoKLSAgIGBTREZzZXRgOiBjb250YWluZXIgZm9yIG1hbnkgU0RGIG9iamVjdHM7IG1vc3QKICAgIGltcG9ydGFudCBzdHJ1Y3R1cmUgY29udGFpbmVyIGZvciBlbmQgdXNlcgoKLSAgIGBTTUlgOiBjb250YWluZXIgZm9yIGEgc2luZ2xlIFNNSUxFUyBzdHJpbmcKCi0gICBgU01Jc2V0YDogY29udGFpbmVyIGZvciBtYW55IFNNSUxFUyBzdHJpbmdzCgpGdW5jdGlvbnMvTWV0aG9kcyAobWFpbmx5IGZvciBgU0RGc2V0YCBjb250YWluZXIsCmBTTUlzZXRgIHNob3VsZCBiZSBjb2VyY2VkIHdpdGgKYHNtaWxlczJzZGAgdG8gYFNERnNldGApCgotICAgQWNjZXNzb3IgbWV0aG9kcyBmb3IgYFNERi9TREZzZXRgCgogICAgLSAgIE9iamVjdCBzbG90czogYGNpZGAsIGBoZWFkZXJgLCBgYXRvbWJsb2NrYCwgYGJvbmRibG9ja2AsCiAgICAgICAgYGRhdGFibG9ja2AgKGBzZGZpZGAsIGBkYXRhYmxvY2t0YWdgKQoKICAgIC0gICBTdW1tYXJ5IG9mIGBTREZzZXRgOiBgdmlld2AKCiAgICAtICAgTWF0cml4IGNvbnZlcnNpb24gb2YgZGF0YSBibG9jazogYGRhdGFibG9jazJtYWAsCiAgICAgICAgYHNwbGl0TnVtQ2hhcmAKCiAgICAtICAgU3RyaW5nIHNlYXJjaCBpbiBTREZzZXQ6IGBncmVwU0RGc2V0YAoKLSAgIENvZXJjZSBvbmUgY2xhc3MgdG8gYW5vdGhlcgoKICAgIC0gICBTdGFuZGFyZCBzeW50YXggYGFzKC4uLiwgIi4uLiIpYCB3b3JrcyBpbiBtb3N0CiAgICAgICAgY2FzZXMuIEZvciBkZXRhaWxzIHNlZSBSIGhlbHAgd2l0aAogICAgICAgYD8iU0RGc2V0LWNsYXNzImAuCgotICAgVXRpbGl0aWVzCgogICAgLSAgIEF0b20gZnJlcXVlbmNpZXM6IGBhdG9tY291bnRNQWAsIGBhdG9tY291bnRgCgogICAgLSAgIE1vbGVjdWxhciB3ZWlnaHQ6IGBNV2AKCiAgICAtICAgTW9sZWN1bGFyIGZvcm11bGE6IGBNRmAKCiAgICAtICAgLi4uCgotICAgQ29tcG91bmQgc3RydWN0dXJlIGRlcGljdGlvbnMKCiAgICAtICAgUiBncmFwaGljcyBkZXZpY2U6IGBwbG90YCwgYHBsb3RTdHJ1Y2AKCiAgICAtICAgT25saW5lOiBgY21wLnZpc3VhbGl6ZWAKCjxkaXYgYWxpZ249InJpZ2h0Ij5bQmFjayB0byBUYWJsZSBvZiBDb250ZW50c10oKTwvZGl2PgoKU3RydWN0dXJlIERlc2NyaXB0b3IgRGF0YQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpDbGFzc2VzCgotICAgYEFQYDogY29udGFpbmVyIGZvciBhdG9tIHBhaXIgZGVzY3JpcHRvcnMgb2YgYSBzaW5nbGUKICAgIG1vbGVjdWxlCgotICAgYEFQc2V0YDogY29udGFpbmVyIGZvciBtYW55IEFQIG9iamVjdHM7IG1vc3QKICAgIGltcG9ydGFudCBzdHJ1Y3R1cmUgZGVzY3JpcHRvciBjb250YWluZXIgZm9yIGVuZCB1c2VyCgotICAgYEZQYDogY29udGFpbmVyIGZvciBmaW5nZXJwcmludCBvZiBhIHNpbmdsZSBtb2xlY3VsZQoKLSAgIGBGUHNldGA6IGNvbnRhaW5lciBmb3IgZmluZ2VycHJpbnRzIG9mIG1hbnkKICAgIG1vbGVjdWxlcywgbW9zdCBpbXBvcnRhbnQgc3RydWN0dXJlIGRlc2NyaXB0b3IgY29udGFpbmVyIGZvciBlbmQKICAgIHVzZXIKCkZ1bmN0aW9ucy9NZXRob2RzCgotICAgQ3JlYXRlIGBBUC9BUHNldGAgaW5zdGFuY2VzCgogICAgLSAgIEZyb20gYFNERnNldGA6IGBzZGYyYXBgCgogICAgLSAgIEZyb20gU0QgZmlsZTogYGNtcC5wYXJzZWAKCiAgICAtICAgU3VtbWFyeSBvZiBgQVAvQVBzZXRgOiBgdmlld2AsCiAgICAgICAgYGRiLmV4cGxhaW5gCgotICAgQWNjZXNzb3IgbWV0aG9kcyBmb3IgQVAvQVBzZXQKCiAgICAtICAgT2JqZWN0IHNsb3RzOiBgYXBgLCBgY2lkYAoKLSAgIENvZXJjZSBvbmUgY2xhc3MgdG8gYW5vdGhlcgoKICAgIC0gICBTdGFuZGFyZCBzeW50YXggYGFzKC4uLiwgIi4uLiIpYCB3b3JrcyBpbiBtb3N0CiAgICAgICAgY2FzZXMuIEZvciBkZXRhaWxzIHNlZSBSIGhlbHAgd2l0aAogICAgICAgIGA/IkFQc2V0LWNsYXNzImAuCgotICAgU3RydWN0dXJlIFNpbWlsYXJpdHkgY29tcGFyaXNvbnMgYW5kIFNlYXJjaGluZwoKICAgIC0gICBDb21wdXRlIHBhaXJ3aXNlIHNpbWlsYXJpdGllcyA6IGBjbXAuc2ltaWxhcml0eWAsCiAgICAgICAgYGZwU2ltYAoKICAgIC0gICBTZWFyY2ggQVBzZXQgZGF0YWJhc2U6IGBjbXAuc2VhcmNoYCwgYGZwU2ltYAoKLSAgIEFQLWJhc2VkIFN0cnVjdHVyZSBTaW1pbGFyaXR5IENsdXN0ZXJpbmcKCiAgICAtICAgU2luZ2xlLWxpbmthZ2UgYmlubmluZyBjbHVzdGVyaW5nOiBgY21wLmNsdXN0ZXJgCgogICAgLSAgIFZpc3VhbGl6ZSBjbHVzdGVyaW5nIHJlc3VsdCB3aXRoIE1EUzoKICAgICAgICBgY2x1c3Rlci52aXN1YWxpemVgCgogICAgLSAgIFNpemUgZGlzdHJpYnV0aW9uIG9mIGNsdXN0ZXJzOiBgY2x1c3Rlci5zaXplc3RhdGAKLSAgIEZvbGRpbmcKICAgIC0gRm9sZCBhIGRlc2NyaXB0b3Igd2l0aCBgZm9sZGAKCSAtIFF1ZXJ5IHRoZSBudW1iZXIgb2YgdGltZXMgYSBkZXNjcmlwdG9yIGhhcyBiZWVuIGZvbGRlZDoKCQlgZm9sZENvdW50YAoJIC0gUXVlcnkgdGhlIG51bWJlciBvZiBiaXRzIGluIGEgZGVzY3JpcHRvcjogYG51bUJpdHNgCgo8ZGl2IGFsaWduPSJyaWdodCI+W0JhY2sgdG8gVGFibGUgb2YgQ29udGVudHNdKCk8L2Rpdj4KCkltcG9ydCBvZiBDb21wb3VuZHMKPT09PT09PT09PT09PT09PT09PQoKU0RGIEltcG9ydAotLS0tLS0tLS0tCgpUaGUgZm9sbG93aW5nIGdpdmVzIGFuIG92ZXJ2aWV3IG9mIHRoZSBtb3N0IGltcG9ydGFudCBpbXBvcnQvZXhwb3J0CmZ1bmN0aW9uYWxpdGllcyBmb3Igc21hbGwgbW9sZWN1bGVzIHByb3ZpZGVkIGJ5CmBDaGVtbWluZVJgLiBUaGUgZ2l2ZW4gZXhhbXBsZSBjcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZQpgU0RGc2V0YCBjbGFzcyB1c2luZyBhcyBzYW1wbGUgZGF0YSBzZXQgdGhlIGZpcnN0IDEwMApjb21wb3VuZHMgZnJvbSB0aGlzIFB1YkNoZW0gU0QgZmlsZSAoU0RGKToKQ29tcG91bmRcXzAwNjUwMDAxXF8wMDY3NTAwMC5zZGYuZ3oKKDxmdHA6Ly9mdHAubmNiaS5uaWguZ292L3B1YmNoZW0vQ29tcG91bmQvQ1VSUkVOVC1GdWxsL1NERi8+KS4KClNERnMgY2FuIGJlIGltcG9ydGVkIHdpdGggdGhlIGByZWFkLlNERnNldGAgZnVuY3Rpb246CgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogc2Rmc2V0IDwtIHJlYWQuU0RGc2V0KCJodHRwOi8vZmFjdWx0eS51Y3IuZWR1L350Z2lya2UvRG9jdW1lbnRzL1JfQmlvQ29uZC9TYW1wbGVzL3NkZnNhbXBsZS5zZGYiKQpgYGAKCmBgYHtyIGV2YWw9VFJVRSwgdGlkeT1GQUxTRX0KIGRhdGEoc2Rmc2FtcGxlKSAjIExvYWRzIHRoZSBzYW1lIFNERnNldCBwcm92aWRlZCBieSB0aGUgbGlicmFyeQogc2Rmc2V0IDwtIHNkZnNhbXBsZQogdmFsaWQgPC0gdmFsaWRTREYoc2Rmc2V0KSAjIElkZW50aWZpZXMgaW52YWxpZCBTREZzIGluIFNERnNldCBvYmplY3RzCiBzZGZzZXQgPC0gc2Rmc2V0W3ZhbGlkXSAjIFJlbW92ZXMgaW52YWxpZCBTREZzLCBpZiB0aGVyZSBhcmUgYW55CmBgYAoKCkltcG9ydCBTRCBmaWxlIGludG8gYFNERnN0cmAgY29udGFpbmVyOgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogc2Rmc3RyIDwtIHJlYWQuU0RGc3RyKCJodHRwOi8vZmFjdWx0eS51Y3IuZWR1L350Z2lya2UvRG9jdW1lbnRzL1JfQmlvQ29uZC9TYW1wbGVzL3NkZnNhbXBsZS5zZGYiKQpgYGAKQ3JlYXRlCmBTREZzZXRgIGZyb20gYFNERnN0cmAgY2xhc3M6CgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBzZGZzdHIgPC0gYXMoc2Rmc2V0LCAiU0RGc3RyIikKIHNkZnN0cgogYXMoc2Rmc3RyLCAiU0RGc2V0IikKYGBgCgo8ZGl2IGFsaWduPSJyaWdodCI+W0JhY2sgdG8gVGFibGUgb2YgQ29udGVudHNdKCk8L2Rpdj4KClNNSUxFUyBJbXBvcnQKLS0tLS0tLS0tLS0tLQoKVGhlIGByZWFkLlNNSXNldGAgZnVuY3Rpb24gaW1wb3J0cyBvbmUgb3IgbWFueSBtb2xlY3VsZXMKZnJvbSBhIFNNSUxFUyBmaWxlIGFuZCBzdG9yZXMgdGhlbSBpbiBhIGBTTUlzZXRgCmNvbnRhaW5lci4gVGhlIGlucHV0IGZpbGUgaXMgZXhwZWN0ZWQgdG8gY29udGFpbiBvbmUgU01JTEVTIHN0cmluZyBwZXIKcm93IHdpdGggdGFiLXNlcGFyYXRlZCBjb21wb3VuZCBpZGVudGlmaWVycyBhdCB0aGUgZW5kIG9mIGVhY2ggbGluZS4gVGhlCmNvbXBvdW5kIGlkZW50aWZpZXJzIGFyZSBvcHRpb25hbC4KCkNyZWF0ZSBzYW1wbGUgU01JTEVTIGZpbGUgYW5kIHRoZW4gaW1wb3J0IGl0OgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogZGF0YShzbWlzYW1wbGUpOyBzbWlzZXQgPC0gc21pc2FtcGxlCiB3cml0ZS5TTUkoc21pc2V0WzE6NF0sIGZpbGU9InN1Yi5zbWkiKQogc21pc2V0IDwtIHJlYWQuU01Jc2V0KCJzdWIuc21pIikKYGBgCgoKSW5zcGVjdCBjb250ZW50IG9mIGBTTUlzZXRgOgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBkYXRhKHNtaXNhbXBsZSkgIyBMb2FkcyB0aGUgc2FtZSBTTUlzZXQgcHJvdmlkZWQgYnkgdGhlIGxpYnJhcnkKIHNtaXNldCA8LSBzbWlzYW1wbGUKIHNtaXNldAogdmlldyhzbWlzZXRbMToyXSkKYGBgCgoKQWNjZXNzb3IgZnVuY3Rpb25zOgpgYGB7ciBldmFsPVRSVUUsIHRpZHk9RkFMU0V9CiBjaWQoc21pc2V0WzE6NF0pCiBzbWkgPC0gYXMuY2hhcmFjdGVyKHNtaXNldFsxOjJdKQpgYGAKCgpDcmVhdGUgYFNNSXNldGAgZnJvbSBuYW1lZCBjaGFyYWN0ZXIgdmVjdG9yOgoKYGBge3IgZXZhbD1UUlVFLCB0aWR5PUZBTFNFfQogYXMoc21pLCAiU01Jc2V0IikKYGBgCgo8ZGl2IGFsaWduPSJyaWdodCI+W0JhY2sgdG8gVGFibGUgb2YgQ29udGVudHNdKCk8L2Rpdj4KCkV4cG9ydCBvZiBDb21wb3VuZHMKPT09PT09PT09PT09PT09PT09PQoKU0RGIEV4cG9ydAotLS0tLS0tLS0tCgpXcml0ZSBvYmplY3RzIG9mIGNsYXNzZXMgYFNERnNldC9TREZzdHIvU0RGYCB0byBTRCBmaWxlOgoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHdyaXRlLlNERihzZGZzZXRbMTo0XSwgZmlsZT0ic3ViLnNkZiIpCmBgYAoKCldyaXRpbmcgY3VzdG9taXplZCBgU0RGc2V0YCB0byBmaWxlIGNvbnRhaW5pbmcKYENoZW1taW5lUmAgc2lnbmF0dXJlLCBJRHMgZnJvbSBgU0RGc2V0YAphbmQgbm8gZGF0YSBibG9jazoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHdyaXRlLlNERihzZGZzZXRbMTo0XSwgZmlsZT0ic3ViLnNkZiIsIHNpZz1UUlVFLCBjaWQ9VFJVRSwgZGI9TlVMTCkKYGBgCgoKRXhhbXBsZSBmb3IgaW5qZWN0aW5nIGEgY3VzdG9tIG1hdHJpeC9kYXRhIGZyYW1lIGludG8gdGhlIGRhdGEgYmxvY2sgb2YKYW4gYFNERnNldGAgYW5kIHRoZW4gd3JpdGluZyBpdCB0byBhbiBTRCBmaWxlOgoKYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHByb3BzIDwtIGRhdGEuZnJhbWUoTUY9TUYoc2Rmc2V0KSwgTVc9TVcoc2Rmc2V0KSwgYXRvbWNvdW50TUEoc2Rmc2V0KSkKIGRhdGFibG9jayhzZGZzZXQpIDwtIHByb3BzCiB3cml0ZS5TREYoc2Rmc2V0WzE6NF0sIGZpbGU9InN1Yi5zZGYiLCBzaWc9VFJVRSwgY2lkPVRSVUUpCmBgYAoKCkluZGlyZWN0IGV4cG9ydCB2aWEgYFNERnN0cmAgb2JqZWN0OgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogc2RmMnN0cihzZGY9c2Rmc2V0W1sxXV0sIHNpZz1UUlVFLCBjaWQ9VFJVRSkgIyBVc2VzIGRlZmF1bHQgY29tcG9uZW50cwogc2RmMnN0cihzZGY9c2Rmc2V0W1sxXV0sIGhlYWQ9bGV0dGVyc1sxOjRdLCBkYj1OVUxMKSAjIFVzZXMgY3VzdG9tIGNvbXBvbmVudHMgZm9yIGhlYWRlciBhbmQgZGF0YSBibG9jawpgYGAKCgpXcml0ZSBgU0RGYCwgYFNERnNldGAgb3IKYFNERnN0cmAgY2xhc3NlcyB0byBmaWxlOgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogd3JpdGUuU0RGKHNkZnNldFsxOjRdLCBmaWxlPSJzdWIuc2RmIiwgc2lnPVRSVUUsIGNpZD1UUlVFLCBkYj1OVUxMKQogd3JpdGUuU0RGKHNkZnN0clsxOjRdLCBmaWxlPSJzdWIuc2RmIikKIGNhdCh1bmxpc3QoYXMoc2Rmc3RyWzE6NF0sICJsaXN0IikpLCBmaWxlPSJzdWIuc2RmIiwgc2VwPSIiKQpgYGAKCjxkaXYgYWxpZ249InJpZ2h0Ij5bQmFjayB0byBUYWJsZSBvZiBDb250ZW50c10oKTwvZGl2PgoKU01JTEVTIEV4cG9ydAotLS0tLS0tLS0tLS0tCgpXcml0ZSBvYmplY3RzIG9mIGNsYXNzIGBTTUlzZXRgIHRvIFNNSUxFUyBmaWxlIHdpdGggYW5kCndpdGhvdXQgY29tcG91bmQgaWRlbnRpZmllcnM6CmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiBkYXRhKHNtaXNhbXBsZSk7IHNtaXNldCA8LSBzbWlzYW1wbGUgIyBTYW1wbGUgZGF0YSBzZXQKCiB3cml0ZS5TTUkoc21pc2V0WzE6NF0sIGZpbGU9InN1Yi5zbWkiLCBjaWQ9VFJVRSkgd3JpdGUuU01JKHNtaXNldFsxOjRdLCBmaWxlPSJzdWIuc21pIiwgY2lkPUZBTFNFKQpgYGAKCjxkaXYgYWxpZ249InJpZ2h0Ij5bQmFjayB0byBUYWJsZSBvZiBDb250ZW50c10oKTwvZGl2PgoKRm9ybWF0IEludGVyY29udmVyc2lvbnMKPT09PT09PT09PT09PT09PT09PT09PT0KClRoZSBgc2RmMnNtaWxlc2AgYW5kIGBzbWlsZXMyc2RmYApmdW5jdGlvbnMgcHJvdmlkZSBmb3JtYXQgaW50ZXJjb252ZXJzaW9uIGJldHdlZW4gU01JTEVTIHN0cmluZ3MKKFNpbXBsaWZpZWQgTW9sZWN1bGFyIElucHV0IExpbmUgRW50cnkgU3BlY2lmaWNhdGlvbikgYW5kCmBTREZzZXRgIGNvbnRhaW5lcnMuCgpDb252ZXJ0IGFuIGBTREZzZXRgIGNvbnRhaW5lciB0byBhIFNNSUxFUwpgY2hhcmFjdGVyYCBzdHJpbmc6CgoKYGBge3Igc2RmMnNtaWxlcywgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIGRhdGEoc2Rmc2FtcGxlKTsKIHNkZnNldCA8LSBzZGZzYW1wbGVbMV0KIHNtaWxlcyA8LSBzZGYyc21pbGVzKHNkZnNldCkKIHNtaWxlcwpgYGAKCgpDb252ZXJ0IGEgU01JTEVTIGBjaGFyYWN0ZXJgIHN0cmluZyB0byBhbgpgU0RGc2V0YCBjb250YWluZXI6CgoKYGBge3Igc21pbGVzMnNkZiwgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIHNkZiA8LSBzbWlsZXMyc2RmKCJDQyg9TylPQzE9Q0M9Q0M9QzFDKD1PKU8iKQogdmlldyhzZGYpCmBgYAoKCldoZW4gdGhlIGBDaGVtaW5lT0JgIHBhY2thZ2UgaXMgaW5zdGFsbGVkIHRoZXNlCmNvbnZlcnNpb25zIGFyZSBwZXJmb3JtZWQgd2l0aCB0aGUgT3BlbkJhYmVsIE9wZW4gU291cmNlIENoZW1pc3RyeQpUb29sYm94LiBPdGhlcndpc2UgdGhlIGZ1bmN0aW9ucyB3aWxsIGZhbGwgYmFjayB0byB1c2luZyB0aGUgQ2hlbU1pbmUKVG9vbHMgd2ViIHNlcnZpY2UgZm9yIHRoaXMgb3BlcmF0aW9uLiBUaGUgbGF0dGVyIHdpbGwgcmVxdWlyZSBpbnRlcm5ldApjb25uZWN0aXZpdHkgYW5kIGlzIGxpbWl0ZWQgdG8gb25seSB0aGUgZmlyc3QgY29tcG91bmQgZ2l2ZW4uCmBDaGVtbWluZU9CYCBwcm92aWRlcyBhY2Nlc3MgdG8gdGhlIGNvbXBvdW5kIGZvcm1hdApjb252ZXJzaW9uIGZ1bmN0aW9ucyBvZiBPcGVuQmFiZWwuIEN1cnJlbnRseSwgb3ZlciAxNjAgZm9ybWF0cyBhcmUKc3VwcG9ydGVkIGJ5IE9wZW5CYWJlbC4gVGhlIGZ1bmN0aW9ucyBgY29udmVydEZvcm1hdGAgYW5kCmBjb252ZXJ0Rm9ybWF0RmlsZWAgY2FuIGJlIHVzZWQgdG8gY29udmVydCBmaWxlcyBvcgpzdHJpbmdzIGJldHdlZW4gYW55IHR3byBmb3JtYXRzIHN1cHBvcnRlZCBieSBPcGVuQmFiZWwuIEZvciBleGFtcGxlLCB0bwpjb252ZXJ0IGEgU01JTEVTIHN0cmluZyB0byBhbiBTREYgc3RyaW5nLCBvbmUgY2FuIHVzZSB0aGUKYGNvbnZlcnRGb3JtYXRgIGZ1bmN0aW9uLgoKCmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiBzZGZTdHIgPC0gY29udmVydEZvcm1hdCgiU01JIiwiU0RGIiwiQ0MoPU8pT0MxPUNDPUNDPUMxQyg9TylPX25hbWUiKQpgYGAKCgpUaGlzIHdpbGwgcmV0dXJuIHRoZSBnaXZlbiBjb21wb3VuZCBhcyBhbiBTREYgZm9ybWF0dGVkIHN0cmluZy4gMkQKY29vcmRpbmF0ZXMgYXJlIGFsc28gY29tcHV0ZWQgYW5kIGluY2x1ZGVkIGluIHRoZSByZXN1bHRpbmcgU0RGIHN0cmluZy4KClRvIGNvbnZlcnQgYSBmaWxlIHdpdGggY29tcG91bmRzIGVuY29kZWQgaW4gb25lIGZvcm1hdCB0byBhbm90aGVyCmZvcm1hdCwgdGhlIGBjb252ZXJ0Rm9ybWF0RmlsZWAgZnVuY3Rpb24gY2FuIGJlIHVzZWQKaW5zdGVhZC4KYGBge3IgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIGNvbnZlcnRGb3JtYXRGaWxlKCJTTUkiLCJTREYiLCJ0ZXN0LnNtaWxlcyIsInRlc3Quc2RmIikKYGBgCgoKVG8gc2VlIHRoZSB3aG9sZSBsaXN0IG9mIGZpbGUgZm9ybWF0cyBzdXBwb3J0ZWQgYnkgT3BlbkJhYmVsLCBvbmUgY2FuCnJ1biBmcm9tIHRoZSBjb21tYW5kLWxpbmUgIm9iYWJlbCAtTCBmb3JtYXRzIi4KCjxkaXYgYWxpZ249InJpZ2h0Ij5bQmFjayB0byBUYWJsZSBvZiBDb250ZW50c10oKTwvZGl2PgoKU3BsaXR0aW5nIFNEIEZpbGVzCj09PT09PT09PT09PT09PT09PQoKVGhlIGZvbGxvd2luZyBgd3JpdGUuU0RGc3BsaXRgIGZ1bmN0aW9uIGFsbG93cyB0byBzcGxpdApTRCBGaWxlcyBpbnRvIGFueSBudW1iZXIgb2Ygc21hbGxlciBTRCBGaWxlcy4gVGhpcyBjYW4gYmVjb21lIGltcG9ydGFudAp3aGVuIHdvcmtpbmcgd2l0aCB2ZXJ5IGJpZyBTRCBGaWxlcy4gVXNlcnMgc2hvdWxkIG5vdGUgdGhhdCB0aGlzCmZ1bmN0aW9uIGNhbiBvdXRwdXQgbWFueSBmaWxlcywgdGh1cyBvbmUgc2hvdWxkIHJ1biBpdCBpbiBhIGRlZGljYXRlZApkaXJlY3RvcnkhCgpDcmVhdGUgc2FtcGxlIFNEIEZpbGUgd2l0aCAxMDAgbW9sZWN1bGVzOgpgYGB7ciBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogd3JpdGUuU0RGKHNkZnNldCwgInRlc3Quc2RmIikKYGBgCgoKUmVhZCBpbiBzYW1wbGUgU0QgRmlsZS4gTm90ZTogcmVhZGluZyBmaWxlIGludG8gU0RGc3RyIGlzIG11Y2ggZmFzdGVyCnRoYW4gaW50byBTREZzZXQ6CmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiBzZGZzdHIgPC0gcmVhZC5TREZzdHIoInRlc3Quc2RmIikKYGBgCgoKUnVuIGV4cG9ydCBvbiBgU0RGc3RyYCBvYmplY3Q6CmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiB3cml0ZS5TREZzcGxpdCh4PXNkZnN0ciwgZmlsZXRhZz0ibXlmaWxlIiwgbm1vbD0xMCkgIyAnbm1vbCcgZGVmaW5lcyB0aGUgbnVtYmVyIG9mIG1vbGVjdWxlcyB0byB3cml0ZSB0byBlYWNoIGZpbGUKYGBgCgoKUnVuIGV4cG9ydCBvbiBgU0RGc2V0YCBvYmplY3Q6CmBgYHtyIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiB3cml0ZS5TREZzcGxpdCh4PXNkZnNldCwgZmlsZXRhZz0ibXlmaWxlIiwgbm1vbD0xMCkKYGBgCgoKU2VhcmNoaW5nIFB1YkNoZW0KPT09PT09PT09PT09PT09PT0KCkdldCBDb21wb3VuZHMgZnJvbSBQdWJDaGVtIGJ5IElkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpUaGUgZnVuY3Rpb24gYGdldElkc2AgYWNjZXB0cyBvbmUgb3IgbW9yZSBudW1lcmljIFB1YkNoZW0KY29tcG91bmQgaWRzIGFuZCBkb3dubG9hZHMgdGhlIGNvcnJlc3BvbmRpbmcgY29tcG91bmRzIGZyb20gUHViQ2hlbQpQb3dlciBVc2VyIEdhdGV3YXkgKFBVRykgcmV0dXJuaW5nIHJlc3VsdHMgaW4gYW4gYFNERnNldGAKY29udGFpbmVyLiBUaGUgQ2hlbU1pbmUgVG9vbHMgd2ViIHNlcnZpY2UgaXMgdXNlZCBhcyBhbiBpbnRlcm1lZGlhdGUsIHRvCnRyYW5zbGF0ZSBxdWVyaWVzIGZyb20gcGxhaW4gSFRUUCBQT1NUIHRvIGEgUFVHIFNPQVAgcXVlcnkuCgpGZXRjaCAyIGNvbXBvdW5kcyBmcm9tIFB1YkNoZW06CgoKYGBge3IgZ2V0SWRzLCBldmFsPUZBTFNFLCB0aWR5PUZBTFNFfQogY29tcG91bmRzIDwtIGdldElkcyhjKDExMSwxMjMpKQogY29tcG91bmRzCmBgYAoKPGRpdiBhbGlnbj0icmlnaHQiPltCYWNrIHRvIFRhYmxlIG9mIENvbnRlbnRzXSgpPC9kaXY+CgpTZWFyY2ggYSBTTUlMRVMgUXVlcnkgaW4gUHViQ2hlbQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKVGhlIGZ1bmN0aW9uIGBzZWFyY2hTdHJpbmdgIGFjY2VwdHMgb25lIFNNSUxFUyBzdHJpbmcKKFNpbXBsaWZpZWQgTW9sZWN1bGFyIElucHV0IExpbmUgRW50cnkgU3BlY2lmaWNhdGlvbikgYW5kIHBlcmZvcm1zIGEKXD4wLjk1IHNpbWlsYXJpdHkgUHViQ2hlbSBmaW5nZXJwcmludCBzZWFyY2gsIHJldHVybmluZyB0aGUgaGl0cyBpbiBhbgpgU0RGc2V0YCBjb250YWluZXIuIFRoZSBDaGVtTWluZSBUb29scyB3ZWIgc2VydmljZSBpcwp1c2VkIGFzIGFuIGludGVybWVkaWF0ZSwgdG8gdHJhbnNsYXRlIHF1ZXJpZXMgZnJvbSBwbGFpbiBIVFRQIFBPU1QgdG8gYQpQdWJDaGVtIFBvd2VyIFVzZXIgR2F0ZXdheSAoUFVHKSBxdWVyeS4KClNlYXJjaCBhIFNNSUxFUyBzdHJpbmcgb24gUHViQ2hlbToKCgpgYGB7ciBzZWFyY2hTdHJpbmcsIGV2YWw9RkFMU0UsIHRpZHk9RkFMU0V9CiBjb21wb3VuZHMgPC0gc2VhcmNoU3RyaW5nKCJDQyg9TylPQzE9Q0M9Q0M9QzFDKD1PKU8iKSBjb21wb3VuZHMKYGBgCgo8ZGl2IGFsaWduPSJyaWdodCI+W0JhY2sgdG8gVGFibGUgb2YgQ29udGVudHNdKCk8L2Rpdj4KClNlYXJjaCBhbiBTREYgUXVlcnkgaW4gUHViQ2hlbQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KClRoZSBmdW5jdGlvbiBgc2VhcmNoU2ltYCBwZXJmb3JtcyBhIFB1YkNoZW0gc2ltaWxhcml0eQpzZWFyY2gganVzdCBsaWtlIGBzZWFyY2hTdHJpbmdgLCBidXQgYWNjZXB0cyBhIHF1ZXJ5IGluCmFuIGBTREZzZXRgIGNvbnRhaW5lci4gSWYgdGhlIHF1ZXJ5IGNvbnRhaW5zIG1vcmUgdGhhbgpvbmUgY29tcG91bmQsIG9ubHkgdGhlIGZpcnN0IGlzIHNlYXJjaGVkLgoKU2VhcmNoIGFuIGBTREZzZXRgIGNvbnRhaW5lciBvbiBQdWJDaGVtOgoKCmBgYHtyIHNlYXJjaFNpbSwgZXZhbD1GQUxTRSwgdGlkeT1GQUxTRX0KIGRhdGEoc2Rmc2FtcGxlKTsKIHNkZnNldCA8LSBzZGZzYW1wbGVbMV0KIGNvbXBvdW5kcyA8LSBzZWFyY2hTaW0oc2Rmc2V0KQogY29tcG91bmRzCmBgYAoKYGBge3Iga25pdF9leGl0LCBpbmNsdWRlPUYsIGVjaG89Rn0Ka25pdF9leGl0KCkKYGBgCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("chem2.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
