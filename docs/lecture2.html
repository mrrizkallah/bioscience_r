<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lecture 2: Statistics and visualizations</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bioinformatics for Pharmacy</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lecture1.html">Lecture 1</a>
    </li>
    <li>
      <a href="lecture2.html">Lecture 2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Lab 1</a>
    </li>
    <li>
      <a href="lab2.html">Lab 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://mrrizkallah.github.io/bioscience_r/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://en.wikipedia.org/wiki/Cooking_school">
    <span class="fa fa-university"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lecture 2: Statistics and visualizations</h1>

</div>


<div id="dna-exercise" class="section level2">
<h2>DNA exercise</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># vector ... etc.</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>my_dna &lt;-<span class="st"> &quot;AACGAATGAGTAAATGAGTAAATGAAGGAATGATTATTCCTTGCTTTAGAACTTCTGGAATTAGAGGACAATATTAATAATACCATCGCACAGTGTTTCTTTGTTGTTAATGCTACAACATACAAAGAGGAAGCATGCAG&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>my_dna</span></code></pre></div>
<pre><code>## [1] &quot;AACGAATGAGTAAATGAGTAAATGAAGGAATGATTATTCCTTGCTTTAGAACTTCTGGAATTAGAGGACAATATTAATAATACCATCGCACAGTGTTTCTTTGTTGTTAATGCTACAACATACAAAGAGGAAGCATGCAG&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">length</span>(my_dna)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">class</span>(my_dna)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">str</span>(my_dna)</span></code></pre></div>
<pre><code>##  chr &quot;AACGAATGAGTAAATGAGTAAATGAAGGAATGATTATTCCTTGCTTTAGAACTTCTGGAATTAGAGGACAATATTAATAATACCATCGCACAGTGTTTCTTTGTTGTTAAT&quot;| __truncated__</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">nchar</span>(my_dna)</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>my_dna_list &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="dt">x =</span> my_dna, <span class="dt">split =</span> <span class="st">&quot;&quot;</span>, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">length</span>(my_dna_list)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">class</span>(my_dna_list)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>my_dna_vector &lt;-<span class="st"> </span><span class="kw">unlist</span>(my_dna_list)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">length</span>(my_dna_list[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">str</span>(my_dna_vector)</span></code></pre></div>
<pre><code>##  chr [1:140] &quot;A&quot; &quot;A&quot; &quot;C&quot; &quot;G&quot; &quot;A&quot; &quot;A&quot; &quot;T&quot; &quot;G&quot; &quot;A&quot; &quot;G&quot; &quot;T&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;T&quot; &quot;G&quot; &quot;A&quot; &quot;G&quot; &quot;T&quot; ...</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">length</span>(my_dna_vector)</span></code></pre></div>
<pre><code>## [1] 140</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># unique characters</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">unique</span>(my_dna_vector)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;C&quot; &quot;G&quot; &quot;T&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># number of As</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>(my_dna_vector <span class="op">==</span><span class="st"> &quot;A&quot;</span>)</span></code></pre></div>
<pre><code>##   [1]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE
##  [16] FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE
##  [31] FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [46] FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
##  [61] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE
##  [76]  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE
##  [91] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [106] FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE
## [121] FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE
## [136] FALSE FALSE FALSE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">length</span>(my_dna_vector[my_dna_vector <span class="op">==</span><span class="st"> &quot;A&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 52</code></pre>
</div>
<div id="frequency-distribution" class="section level2">
<h2>Frequency distribution</h2>
<p>A gene consists of a sequence of nucleotides {A, C, G, T}.The number of each nucleotide can be displayed in a frequency table. This will be illustrated by the Zyxin gene which plays an important role in cell adhesion (Golub et al., 1999). The accession number (X94991.1) of oneof its variants can be found via an NCBI UniGene search. The code below illustrates how to install the package ape, to load it, to read gene ”X94991.1”of the species homo sapiens from GenBank, and to make a frequency table of the four nucleotides</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;ape&quot;</span>), <span class="dt">repo=</span><span class="st">&quot;http://cran.r-project.org&quot;</span>, <span class="dt">dep=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Installing package into &#39;/home/mariam/R/x86_64-pc-linux-gnu-library/4.0&#39;
## (as &#39;lib&#39; is unspecified)</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">library</span>(ape)</span>
<span id="cb29-2"><a href="#cb29-2"></a>gene &lt;-<span class="st"> </span><span class="kw">read.GenBank</span>(<span class="kw">c</span>(<span class="st">&quot;X94991.1&quot;</span>),  <span class="dt">as.character=</span><span class="ot">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">table</span>(gene)</span></code></pre></div>
<pre><code>## gene
##   a   c   g   t 
## 410 789 573 394</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">pie</span>(<span class="kw">table</span>(gene))</span></code></pre></div>
<p><img src="lecture2_files/figure-html/freq1-1.png" width="672" /> # Probability and Statistics in <code>R</code></p>
</div>
<div id="probability-in-r" class="section level2">
<h2>Probability in <code>R</code></h2>
<div id="distributions" class="section level3">
<h3>Distributions</h3>
<p>When working with different statistical distributions, we often want to make probabilistic statements based on the distribution.</p>
<p>We typically want to know one of four things:</p>
<ul>
<li>The density (pdf) at a particular value.</li>
<li>The distribution (cdf) at a particular value.</li>
<li>The quantile value corresponding to a particular probability.</li>
<li>A random draw of values from a particular distribution.</li>
</ul>
<p>This used to be done with statistical tables printed in the back of textbooks. Now, <code>R</code> has functions for obtaining density, distribution, quantile and random values.</p>
<p>The general naming structure of the relevant <code>R</code> functions is:</p>
<ul>
<li><code>dname</code> calculates density (pdf) at input <code>x</code>.</li>
<li><code>pname</code> calculates distribution (cdf) at input <code>x</code>.</li>
<li><code>qname</code> calculates the quantile at an input probability.</li>
<li><code>rname</code> generates a random draw from a particular distribution.</li>
</ul>
<p>Note that <code>name</code> represents the name of the given distribution.</p>
<p>For example, consider a random variable <span class="math inline">\(X\)</span> which is <span class="math inline">\(N(\mu = 2, \sigma^2 = 25)\)</span>. (Note, we are parameterizing using the variance <span class="math inline">\(\sigma^2\)</span>. <code>R</code> however uses the standard deviation.)</p>
<p>To calculate the value of the pdf at <code>x = 3</code>, that is, the height of the curve at <code>x = 3</code>, use:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">dnorm</span>(<span class="dt">x =</span> <span class="dv">3</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07820854</code></pre>
<p>To calculate the value of the cdf at <code>x = 3</code>, that is, <span class="math inline">\(P(X \leq 3)\)</span>, the probability that <span class="math inline">\(X\)</span> is less than or equal to <code>3</code>, use:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">pnorm</span>(<span class="dt">q =</span> <span class="dv">3</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.5792597</code></pre>
<p>Or, to calculate the quantile for probability 0.975, use:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.975</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 11.79982</code></pre>
<p>Lastly, to generate a random sample of size <code>n = 10</code>, use:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##  [1] 10.698725  8.543128  8.216379  2.847067  1.152390 -2.475338  4.852992 -1.232086 10.173347
## [10]  8.018600</code></pre>
<p>These functions exist for many other distributions, including but not limited to:</p>
<table>
<thead>
<tr class="header">
<th>Command</th>
<th>Distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>*binom</code></td>
<td>Binomial</td>
</tr>
<tr class="even">
<td><code>*t</code></td>
<td>t</td>
</tr>
<tr class="odd">
<td><code>*pois</code></td>
<td>Poisson</td>
</tr>
<tr class="even">
<td><code>*f</code></td>
<td>F</td>
</tr>
<tr class="odd">
<td><code>*chisq</code></td>
<td>Chi-Squared</td>
</tr>
</tbody>
</table>
<p>Where <code>*</code> can be <code>d</code>, <code>p</code>, <code>q</code>, and <code>r</code>. Each distribution will have its own set of parameters which need to be passed to the functions as arguments. For example, <code>dbinom()</code> would not have arguments for <code>mean</code> and <code>sd</code>, since those are not parameters of the distribution. Instead a binomial distribution is usually parameterized by <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, however <code>R</code> chooses to call them something else. To find the names that <code>R</code> uses we would use <code>?dbinom</code> and see that <code>R</code> instead calls the arguments <code>size</code> and <code>prob</code>. For example:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<pre><code>## [1] 0.145998</code></pre>
<p>Also note that, when using the <code>dname</code> functions with discrete distributions, they are the pmf of the distribution. For example, the above command is <span class="math inline">\(P(Y = 6)\)</span> if <span class="math inline">\(Y \sim b(n = 10, p = 0.75)\)</span>. (The probability of flipping an unfair coin <code>10</code> times and seeing <code>6</code> heads, if the probability of heads is <code>0.75</code>.)</p>
</div>
</div>
<div id="hypothesis-tests-in-r" class="section level2">
<h2>Hypothesis Tests in <code>R</code></h2>
<p>A prerequisite for STAT 420 is an understanding of the basics of hypothesis testing. Recall the basic structure of hypothesis tests:</p>
<ul>
<li>An overall model and related assumptions are made. (The most common being observations following a normal distribution.)</li>
<li>The <strong>null</strong> (<span class="math inline">\(H_{0}\)</span>) and <strong>alternative</strong> (<span class="math inline">\(H_{1}\)</span> or <span class="math inline">\(H_{A}\)</span>) hypothesis are specified. Usually the null specifies a particular value of a parameter.</li>
<li>With given data, the <strong>value</strong> of the <em>test statistic</em> is calculated.</li>
<li>Under the general assumptions, as well as assuming the null hypothesis is true, the <strong>distribution</strong> of the <em>test statistic</em> is known.</li>
<li>Given the distribution and value of the test statistic, as well as the form of the alternative hypothesis, we can calculate a <strong>p-value</strong> of the test.</li>
<li>Based on the <strong>p-value</strong> and pre-specified level of significance, we make a decision. One of:
<ul>
<li>Fail to reject the null hypothesis.</li>
<li>Reject the null hypothesis.</li>
</ul></li>
</ul>
<p>We’ll do some quick review of two of the most common tests to show how they are performed using <code>R</code>.</p>
<div id="one-sample-t-test-review" class="section level3">
<h3>One Sample t-Test: Review</h3>
<p>Suppose <span class="math inline">\(x_{i} \sim \mathrm{N}(\mu,\sigma^{2})\)</span> and we want to test <span class="math inline">\(H_{0}: \mu = \mu_{0}\)</span> versus <span class="math inline">\(H_{1}: \mu \neq \mu_{0}.\)</span></p>
<p>Assuming <span class="math inline">\(\sigma\)</span> is unknown, we use the one-sample Student’s <span class="math inline">\(t\)</span> test statistic:</p>
<p><span class="math display">\[
t = \frac{\bar{x}-\mu_{0}}{s/\sqrt{n}} \sim t_{n-1},
\]</span></p>
<p>where <span class="math inline">\(\bar{x} = \displaystyle\frac{\sum_{i=1}^{n}x_{i}}{n}\)</span> and <span class="math inline">\(s = \sqrt{\displaystyle\frac{1}{n - 1}\sum_{i=1}^{n}(x_i - \bar{x})^2}\)</span>.</p>
<p>A <span class="math inline">\(100(1 - \alpha)\)</span>% confidence interval for <span class="math inline">\(\mu\)</span> is given by,</p>
<p><span class="math display">\[
\bar{x} \pm t_{n-1}(\alpha/2)\frac{s}{\sqrt{n}}
\]</span></p>
<p>where <span class="math inline">\(t_{n-1}(\alpha/2)\)</span> is the critical value such that <span class="math inline">\(P\left(t&gt;t_{n-1}(\alpha/2)\right) = \alpha/2\)</span> for <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</div>
<div id="one-sample-t-test-example" class="section level3">
<h3>One Sample t-Test: Example</h3>
<p>Suppose a grocery store sells “16 ounce” boxes of <em>Captain Crisp</em> cereal. A random sample of 9 boxes was taken and weighed. The weight in ounces are stored in the data frame <code>capt_crisp</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>capt_crisp =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">weight =</span> <span class="kw">c</span>(<span class="fl">15.5</span>, <span class="fl">16.2</span>, <span class="fl">16.1</span>, <span class="fl">15.8</span>, <span class="fl">15.6</span>, <span class="fl">16.0</span>, <span class="fl">15.8</span>, <span class="fl">15.9</span>, <span class="fl">16.2</span>))</span></code></pre></div>
<p>The company that makes <em>Captain Crisp</em> cereal claims that the average weight of a box is at least 16 ounces. We will assume the weight of cereal in a box is normally distributed and use a 0.05 level of significance to test the company’s claim.</p>
<p>To test <span class="math inline">\(H_{0}: \mu \geq 16\)</span> versus <span class="math inline">\(H_{1}: \mu &lt; 16\)</span>, the test statistic is</p>
<p><span class="math display">\[
t = \frac{\bar{x} - \mu_{0}}{s / \sqrt{n}}
\]</span></p>
<p>The sample mean <span class="math inline">\(\bar{x}\)</span> and the sample standard deviation <span class="math inline">\(s\)</span> can be easily computed using <code>R</code>. We also create variables which store the hypothesized mean and the sample size.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>x_bar =<span class="st"> </span><span class="kw">mean</span>(capt_crisp<span class="op">$</span>weight)</span>
<span id="cb43-2"><a href="#cb43-2"></a>s     =<span class="st"> </span><span class="kw">sd</span>(capt_crisp<span class="op">$</span>weight)</span>
<span id="cb43-3"><a href="#cb43-3"></a>mu_<span class="dv">0</span>  =<span class="st"> </span><span class="dv">16</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>n     =<span class="st"> </span><span class="dv">9</span></span></code></pre></div>
<p>We can then easily compute the test statistic.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>t =<span class="st"> </span>(x_bar <span class="op">-</span><span class="st"> </span>mu_<span class="dv">0</span>) <span class="op">/</span><span class="st"> </span>(s <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</span>
<span id="cb44-2"><a href="#cb44-2"></a>t</span></code></pre></div>
<pre><code>## [1] -1.2</code></pre>
<p>Under the null hypothesis, the test statistic has a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n - 1\)</span> degrees of freedom, in this case 8.</p>
<p>To complete the test, we need to obtain the p-value of the test. Since this is a one-sided test with a less-than alternative, we need the area to the left of -1.2 for a <span class="math inline">\(t\)</span> distribution with 8 degrees of freedom. That is,</p>
<p><span class="math display">\[
P(t_{8} &lt; -1.2)
\]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">pt</span>(t, <span class="dt">df =</span> n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1322336</code></pre>
<p>We now have the p-value of our test, which is greater than our significance level (0.05), so we fail to reject the null hypothesis.</p>
<p>Alternatively, this entire process could have been completed using one line of <code>R</code> code.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">t.test</span>(<span class="dt">x =</span> capt_crisp<span class="op">$</span>weight, <span class="dt">mu =</span> <span class="dv">16</span>, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;less&quot;</span>), <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  capt_crisp$weight
## t = -1.2, df = 8, p-value = 0.1322
## alternative hypothesis: true mean is less than 16
## 95 percent confidence interval:
##      -Inf 16.05496
## sample estimates:
## mean of x 
##      15.9</code></pre>
<p>We supply <code>R</code> with the data, the hypothesized value of <span class="math inline">\(\mu\)</span>, the alternative, and the confidence level. <code>R</code> then returns a wealth of information including:</p>
<ul>
<li>The value of the test statistic.</li>
<li>The degrees of freedom of the distribution under the null hypothesis.</li>
<li>The p-value of the test.</li>
<li>The confidence interval which corresponds to the test.</li>
<li>An estimate of <span class="math inline">\(\mu\)</span>.</li>
</ul>
<p>Since the test was one-sided, <code>R</code> returned a one-sided confidence interval. If instead we wanted a two-sided interval for the mean weight of boxes of <em>Captain Crisp</em> cereal we could modify our code.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>capt_test_results =<span class="st"> </span><span class="kw">t.test</span>(capt_crisp<span class="op">$</span>weight, <span class="dt">mu =</span> <span class="dv">16</span>,</span>
<span id="cb50-2"><a href="#cb50-2"></a>                           <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>), <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>This time we have stored the results. By doing so, we can directly access portions of the output from <code>t.test()</code>. To see what information is available we use the <code>names()</code> function.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">names</span>(capt_test_results)</span></code></pre></div>
<pre><code>##  [1] &quot;statistic&quot;   &quot;parameter&quot;   &quot;p.value&quot;     &quot;conf.int&quot;    &quot;estimate&quot;    &quot;null.value&quot; 
##  [7] &quot;stderr&quot;      &quot;alternative&quot; &quot;method&quot;      &quot;data.name&quot;</code></pre>
<p>We are interested in the confidence interval which is stored in <code>conf.int</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>capt_test_results<span class="op">$</span>conf.int</span></code></pre></div>
<pre><code>## [1] 15.70783 16.09217
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<p>Let’s check this interval “by hand.” The one piece of information we are missing is the critical value, <span class="math inline">\(t_{n-1}(\alpha/2) = t_{8}(0.025)\)</span>, which can be calculated in <code>R</code> using the <code>qt()</code> function.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 2.306004</code></pre>
<p>So, the 95% CI for the mean weight of a cereal box is calculated by plugging into the formula,</p>
<p><span class="math display">\[
\bar{x} \pm t_{n-1}(\alpha/2) \frac{s}{\sqrt{n}}
\]</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">c</span>(<span class="kw">mean</span>(capt_crisp<span class="op">$</span>weight) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(capt_crisp<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>),</span>
<span id="cb57-2"><a href="#cb57-2"></a>  <span class="kw">mean</span>(capt_crisp<span class="op">$</span>weight) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df =</span> <span class="dv">8</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(capt_crisp<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">9</span>))</span></code></pre></div>
<pre><code>## [1] 15.70783 16.09217</code></pre>
</div>
<div id="two-sample-t-test-review" class="section level3">
<h3>Two Sample t-Test: Review</h3>
<p>Suppose <span class="math inline">\(x_{i} \sim \mathrm{N}(\mu_{x}, \sigma^{2})\)</span> and <span class="math inline">\(y_{i} \sim \mathrm{N}(\mu_{y}, \sigma^{2}).\)</span></p>
<p>Want to test <span class="math inline">\(H_{0}: \mu_{x} - \mu_{y} = \mu_{0}\)</span> versus <span class="math inline">\(H_{1}: \mu_{x} - \mu_{y} \neq \mu_{0}.\)</span></p>
<p>Assuming <span class="math inline">\(\sigma\)</span> is unknown, use the two-sample Student’s <span class="math inline">\(t\)</span> test statistic:</p>
<p><span class="math display">\[
t = \frac{(\bar{x} - \bar{y})-\mu_{0}}{s_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t_{n+m-2},
\]</span></p>
<p>where <span class="math inline">\(\displaystyle\bar{x}=\frac{\sum_{i=1}^{n}x_{i}}{n}\)</span>, <span class="math inline">\(\displaystyle\bar{y}=\frac{\sum_{i=1}^{m}y_{i}}{m}\)</span>, and <span class="math inline">\(s_p^2 = \displaystyle\frac{(n-1)s_x^2+(m-1)s_y^2}{n+m-2}\)</span>.</p>
<p>A <span class="math inline">\(100(1-\alpha)\)</span>% CI for <span class="math inline">\(\mu_{x}-\mu_{y}\)</span> is given by</p>
<p><span class="math display">\[
(\bar{x} - \bar{y}) \pm t_{n+m-2}(\alpha/2) \left(s_{p}\textstyle\sqrt{\frac{1}{n}+\frac{1}{m}}\right),
\]</span></p>
<p>where <span class="math inline">\(t_{n+m-2}(\alpha/2)\)</span> is the critical value such that <span class="math inline">\(P\left(t&gt;t_{n+m-2}(\alpha/2)\right)=\alpha/2\)</span>.</p>
</div>
<div id="two-sample-t-test-example" class="section level3">
<h3>Two Sample t-Test: Example</h3>
<p>Assume that the distributions of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are <span class="math inline">\(\mathrm{N}(\mu_{1},\sigma^{2})\)</span> and <span class="math inline">\(\mathrm{N}(\mu_{2},\sigma^{2})\)</span>, respectively. Given the <span class="math inline">\(n = 6\)</span> observations of <span class="math inline">\(X\)</span>,</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">82</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">94</span>, <span class="dv">82</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>n =<span class="st"> </span><span class="kw">length</span>(x)</span></code></pre></div>
<p>and the <span class="math inline">\(m = 8\)</span> observations of <span class="math inline">\(Y\)</span>,</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">64</span>, <span class="dv">72</span>, <span class="dv">60</span>, <span class="dv">76</span>, <span class="dv">72</span>, <span class="dv">80</span>, <span class="dv">84</span>, <span class="dv">68</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a>m =<span class="st"> </span><span class="kw">length</span>(y)</span></code></pre></div>
<p>we will test <span class="math inline">\(H_{0}: \mu_{1} = \mu_{2}\)</span> versus <span class="math inline">\(H_{1}: \mu_{1} &gt; \mu_{2}\)</span>.</p>
<p>First, note that we can calculate the sample means and standard deviations.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>x_bar =<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb61-2"><a href="#cb61-2"></a>s_x   =<span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb61-3"><a href="#cb61-3"></a>y_bar =<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb61-4"><a href="#cb61-4"></a>s_y   =<span class="st"> </span><span class="kw">sd</span>(y)</span></code></pre></div>
<p>We can then calculate the pooled standard deviation.</p>
<p><span class="math display">\[
s_{p} = \sqrt{\frac{(n-1)s_{x}^{2}+(m-1)s_{y}^{2}}{n+m-2}}
\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>s_p =<span class="st"> </span><span class="kw">sqrt</span>(((n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>s_x <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(m <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>s_y <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(n <span class="op">+</span><span class="st"> </span>m <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</span></code></pre></div>
<p>Thus, the relevant <span class="math inline">\(t\)</span> test statistic is given by</p>
<p><span class="math display">\[
t = \frac{(\bar{x}-\bar{y})-\mu_{0}}{s_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}.
\]</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>t =<span class="st"> </span>((x_bar <span class="op">-</span><span class="st"> </span>y_bar) <span class="op">-</span><span class="st"> </span><span class="dv">0</span>) <span class="op">/</span><span class="st"> </span>(s_p <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>m))</span>
<span id="cb63-2"><a href="#cb63-2"></a>t</span></code></pre></div>
<pre><code>## [1] 1.823369</code></pre>
<p>Note that <span class="math inline">\(t \sim t_{n + m - 2} = t_{12}\)</span>, so we can calculate the p-value, which is</p>
<p><span class="math display">\[
P(t_{12} &gt; 1.8233692).
\]</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(t, <span class="dt">df =</span> n <span class="op">+</span><span class="st"> </span>m <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.04661961</code></pre>
<p>But, then again, we could have simply performed this test in one line of <code>R</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">t.test</span>(x, y, <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;greater&quot;</span>), <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  x and y
## t = 1.8234, df = 12, p-value = 0.04662
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.1802451       Inf
## sample estimates:
## mean of x mean of y 
##        80        72</code></pre>
<p>Recall that a two-sample <span class="math inline">\(t\)</span>-test can be done with or without an equal variance assumption. Here <code>var.equal = TRUE</code> tells <code>R</code> we would like to perform the test under the equal variance assumption.</p>
<p>Above we carried out the analysis using two vectors <code>x</code> and <code>y</code>. In general, we will have a preference for using data frames.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>t_test_data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">values =</span> <span class="kw">c</span>(x, y),</span>
<span id="cb69-2"><a href="#cb69-2"></a>                         <span class="dt">group  =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">length</span>(x)), <span class="kw">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="kw">length</span>(y))))</span></code></pre></div>
<p>We now have the data stored in a single variables (<code>values</code>) and have created a second variable (<code>group</code>) which indicates which “sample” the value belongs to.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>t_test_data</span></code></pre></div>
<pre><code>##    values group
## 1      70     A
## 2      82     A
## 3      78     A
## 4      74     A
## 5      94     A
## 6      82     A
## 7      64     B
## 8      72     B
## 9      60     B
## 10     76     B
## 11     72     B
## 12     80     B
## 13     84     B
## 14     68     B</code></pre>
<p>Now to perform the test, we still use the <code>t.test()</code> function but with the <code>~</code> syntax and a <code>data</code> argument.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">t.test</span>(values <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> t_test_data,</span>
<span id="cb72-2"><a href="#cb72-2"></a>       <span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;greater&quot;</span>), <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  values by group
## t = 1.8234, df = 12, p-value = 0.04662
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.1802451       Inf
## sample estimates:
## mean in group A mean in group B 
##              80              72</code></pre>
</div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>Simulation and model fitting are related but opposite processes.</p>
<ul>
<li>In <strong>simulation</strong>, the <em>data generating process</em> is known. We will know the form of the model as well as the value of each of the parameters. In particular, we will often control the distribution and parameters which define the randomness, or noise in the data.</li>
<li>In <strong>model fitting</strong>, the <em>data</em> is known. We will then assume a certain form of model and find the best possible values of the parameters given the observed data. Essentially we are seeking to uncover the truth. Often we will attempt to fit many models, and we will learn metrics to assess which model fits best.</li>
</ul>
<div class="figure">
<img src="images/simulation.png" alt="" />
<p class="caption">Simulation vs Modeling</p>
</div>
<p>Often we will simulate data according to a process we decide, then use a modeling method seen in class. We can then verify how well the method works, since we know the data generating process.</p>
<p>One of the biggest strengths of <code>R</code> is its ability to carry out simulations using built-in functions for generating random samples from certain distributions. We’ll look at two very simple examples here, however simulation will be a topic we revisit several times throughout the course.</p>
<div id="paired-differences" class="section level3">
<h3>Paired Differences</h3>
<p>Consider the model:</p>
<p><span class="math display">\[
\begin{split}
X_{11}, X_{12}, \ldots, X_{1n} \sim N(\mu_1,\sigma^2)\\
X_{21}, X_{22}, \ldots, X_{2n} \sim N(\mu_2,\sigma^2)
\end{split}
\]</span></p>
<p>Assume that <span class="math inline">\(\mu_1 = 6\)</span>, <span class="math inline">\(\mu_2 = 5\)</span>, <span class="math inline">\(\sigma^2 = 4\)</span> and <span class="math inline">\(n = 25\)</span>.</p>
<p>Let</p>
<p><span class="math display">\[
\begin{aligned}
\bar{X}_1 &amp;= \displaystyle\frac{1}{n}\sum_{i=1}^{n}X_{1i}\\
\bar{X}_2 &amp;= \displaystyle\frac{1}{n}\sum_{i=1}^{n}X_{2i}\\
D &amp;= \bar{X}_1 - \bar{X}_2.
\end{aligned}
\]</span></p>
<p>Suppose we would like to calculate <span class="math inline">\(P(0 &lt; D &lt; 2)\)</span>. First we will need to obtain the distribution of <span class="math inline">\(D\)</span>.</p>
<p>Recall,</p>
<p><span class="math display">\[
\bar{X}_1 \sim N\left(\mu_1,\frac{\sigma^2}{n}\right)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\bar{X}_2 \sim N\left(\mu_2,\frac{\sigma^2}{n}\right).
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
D = \bar{X}_1 - \bar{X}_2 \sim N\left(\mu_1-\mu_2, \frac{\sigma^2}{n} + \frac{\sigma^2}{n}\right) = N\left(6-5, \frac{4}{25} + \frac{4}{25}\right).
\]</span></p>
<p>So,</p>
<p><span class="math display">\[
D \sim N(\mu = 1, \sigma^2 = 0.32).
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
P(0 &lt; D &lt; 2) = P(D &lt; 2) - P(D &lt; 0).
\]</span></p>
<p>This can then be calculated using <code>R</code> without a need to first standardize, or use a table.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">pnorm</span>(<span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="fl">0.32</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">0</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="fl">0.32</span>))</span></code></pre></div>
<pre><code>## [1] 0.9229001</code></pre>
<p>An alternative approach, would be to <strong>simulate</strong> a large number of observations of <span class="math inline">\(D\)</span> then use the <strong>empirical distribution</strong> to calculate the probability.</p>
<p>Our strategy will be to repeatedly:</p>
<ul>
<li>Generate a sample of 25 random observations from <span class="math inline">\(N(\mu_1 = 6,\sigma^2 = 4)\)</span>. Call the mean of this sample <span class="math inline">\(\bar{x}_{1s}\)</span>.</li>
<li>Generate a sample of 25 random observations from <span class="math inline">\(N(\mu_1 = 5,\sigma^2 = 4)\)</span>. Call the mean of this sample <span class="math inline">\(\bar{x}_{2s}\)</span>.</li>
<li>Calculate the differences of the means, <span class="math inline">\(d_s = \bar{x}_{1s} - \bar{x}_{2s}\)</span>.</li>
</ul>
<p>We will repeat the process a large number of times. Then we will use the distribution of the simulated observations of <span class="math inline">\(d_s\)</span> as an estimate for the true distribution of <span class="math inline">\(D\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>num_samples =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>differences =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, num_samples)</span></code></pre></div>
<p>Before starting our <code>for</code> loop to perform the operation, we set a seed for reproducibility, create and set a variable <code>num_samples</code> which will define the number of repetitions, and lastly create a variables <code>differences</code> which will store the simulate values, <span class="math inline">\(d_s\)</span>.</p>
<p>By using <code>set.seed()</code> we can reproduce the random results of <code>rnorm()</code> each time starting from that line.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_samples) {</span>
<span id="cb77-2"><a href="#cb77-2"></a>  x1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">6</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a>  x2 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">25</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb77-4"><a href="#cb77-4"></a>  differences[s] =<span class="st"> </span><span class="kw">mean</span>(x1) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x2)</span>
<span id="cb77-5"><a href="#cb77-5"></a>}</span></code></pre></div>
<p>To estimate <span class="math inline">\(P(0 &lt; D &lt; 2)\)</span> we will find the proportion of values of <span class="math inline">\(d_s\)</span> (among the 10^{4} values of <span class="math inline">\(d_s\)</span> generated) that are between 0 and 2.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">mean</span>(<span class="dv">0</span> <span class="op">&lt;</span><span class="st"> </span>differences <span class="op">&amp;</span><span class="st"> </span>differences <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9222</code></pre>
<p>Recall that above we derived the distribution of <span class="math inline">\(D\)</span> to be <span class="math inline">\(N(\mu = 1, \sigma^2 = 0.32)\)</span></p>
<p>If we look at a histogram of the differences, we find that it looks very much like a normal distribution.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">hist</span>(differences, <span class="dt">breaks =</span> <span class="dv">20</span>, </span>
<span id="cb80-2"><a href="#cb80-2"></a>     <span class="dt">main   =</span> <span class="st">&quot;Empirical Distribution of D&quot;</span>,</span>
<span id="cb80-3"><a href="#cb80-3"></a>     <span class="dt">xlab   =</span> <span class="st">&quot;Simulated Values of D&quot;</span>,</span>
<span id="cb80-4"><a href="#cb80-4"></a>     <span class="dt">col    =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb80-5"><a href="#cb80-5"></a>     <span class="dt">border =</span> <span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Also the sample mean and variance are very close to to what we would expect.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">mean</span>(differences)</span></code></pre></div>
<pre><code>## [1] 1.001423</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">var</span>(differences)</span></code></pre></div>
<pre><code>## [1] 0.3230183</code></pre>
<p>We could have also accomplished this task with a single line of more “idiomatic” <code>R</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>diffs =<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">6</span>, <span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">5</span>, <span class="dv">2</span>)))</span></code></pre></div>
<p>Use <code>?replicate</code> to take a look at the documentation for the <code>replicate</code> function and see if you can understand how this line performs the same operations that our <code>for</code> loop above executed.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">mean</span>(differences <span class="op">==</span><span class="st"> </span>diffs)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>We see that by setting the same seed for the randomization, we actually obtain identical results!</p>
</div>
<div id="distribution-of-a-sample-mean" class="section level3">
<h3>Distribution of a Sample Mean</h3>
<p>For another example of simulation, we will simulate observations from a Poisson distribution, and examine the empirical distribution of the sample mean of these observations.</p>
<p>Recall, if</p>
<p><span class="math display">\[
X \sim Pois(\mu)
\]</span></p>
<p>then</p>
<p><span class="math display">\[
E[X] = \mu
\]</span></p>
<p>and</p>
<p><span class="math display">\[
Var[X] = \mu.
\]</span></p>
<p>Also, recall that for a random variable <span class="math inline">\(X\)</span> with finite mean <span class="math inline">\(\mu\)</span> and finite variance <span class="math inline">\(\sigma^2\)</span>, the central limit theorem tells us that the mean, <span class="math inline">\(\bar{X}\)</span> of a random sample of size <span class="math inline">\(n\)</span> is approximately normal for <em>large</em> values of <span class="math inline">\(n\)</span>. Specifically, as <span class="math inline">\(n \to \infty\)</span>,</p>
<p><span class="math display">\[
\bar{X} \overset{d}{\to} N\left(\mu, \frac{\sigma^2}{n}\right).
\]</span></p>
<p>The following verifies this result for a Poisson distribution with <span class="math inline">\(\mu = 10\)</span> and a sample size of <span class="math inline">\(n = 50\)</span>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>mu          =<span class="st"> </span><span class="dv">10</span></span>
<span id="cb88-3"><a href="#cb88-3"></a>sample_size =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb88-4"><a href="#cb88-4"></a>samples     =<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb88-5"><a href="#cb88-5"></a>x_bars      =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, samples)</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>samples){</span>
<span id="cb89-2"><a href="#cb89-2"></a>  x_bars[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rpois</span>(sample_size, <span class="dt">lambda =</span> mu))</span>
<span id="cb89-3"><a href="#cb89-3"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>x_bar_hist =<span class="st"> </span><span class="kw">hist</span>(x_bars, <span class="dt">breaks =</span> <span class="dv">50</span>, </span>
<span id="cb90-2"><a href="#cb90-2"></a>                  <span class="dt">main =</span> <span class="st">&quot;Histogram of Sample Means&quot;</span>,</span>
<span id="cb90-3"><a href="#cb90-3"></a>                  <span class="dt">xlab =</span> <span class="st">&quot;Sample Means&quot;</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Now we will compare sample statistics from the empirical distribution with their known values based on the parent distribution.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">c</span>(<span class="kw">mean</span>(x_bars), mu)</span></code></pre></div>
<pre><code>## [1] 10.00008 10.00000</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="kw">c</span>(<span class="kw">var</span>(x_bars), mu <span class="op">/</span><span class="st"> </span>sample_size)</span></code></pre></div>
<pre><code>## [1] 0.1989732 0.2000000</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">c</span>(<span class="kw">sd</span>(x_bars), <span class="kw">sqrt</span>(mu) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sample_size))</span></code></pre></div>
<pre><code>## [1] 0.4460641 0.4472136</code></pre>
<p>And here, we will calculate the proportion of sample means that are within 2 standard deviations of the population mean.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">mean</span>(x_bars <span class="op">&gt;</span><span class="st"> </span>mu <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(mu) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sample_size) <span class="op">&amp;</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="st">     </span>x_bars <span class="op">&lt;</span><span class="st"> </span>mu <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(mu) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sample_size))</span></code></pre></div>
<pre><code>## [1] 0.95429</code></pre>
<p>This last histogram uses a bit of a trick to approximately shade the bars that are within two standard deviations of the mean.)</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>shading =<span class="st"> </span><span class="kw">ifelse</span>(x_bar_hist<span class="op">$</span>breaks <span class="op">&gt;</span><span class="st"> </span>mu <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(mu) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sample_size) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="st">                   </span>x_bar_hist<span class="op">$</span>breaks <span class="op">&lt;</span><span class="st"> </span>mu <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(mu) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sample_size),</span>
<span id="cb99-3"><a href="#cb99-3"></a>                  <span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>)</span>
<span id="cb99-4"><a href="#cb99-4"></a></span>
<span id="cb99-5"><a href="#cb99-5"></a>x_bar_hist =<span class="st"> </span><span class="kw">hist</span>(x_bars, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">col =</span> shading,</span>
<span id="cb99-6"><a href="#cb99-6"></a>                  <span class="dt">main =</span> <span class="st">&quot;Histogram of Sample Means, Two Standard Deviations&quot;</span>,</span>
<span id="cb99-7"><a href="#cb99-7"></a>                  <span class="dt">xlab =</span> <span class="st">&quot;Sample Means&quot;</span>)</span></code></pre></div>
<p><img src="lecture2_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTGVjdHVyZSAyOiBTdGF0aXN0aWNzIGFuZCB2aXN1YWxpemF0aW9ucyIKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0KbGlicmFyeShrbml0cikKa25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFKQpgYGAKCiMjIEROQSBleGVyY2lzZQpgYGB7ciBkbmFfZXgyLCBpbmNsdWRlID0gVCwgZWNobz1ULCBldmFsPVR9CiMgdmVjdG9yIC4uLiBldGMuCm15X2RuYSA8LSAiQUFDR0FBVEdBR1RBQUFUR0FHVEFBQVRHQUFHR0FBVEdBVFRBVFRDQ1RUR0NUVFRBR0FBQ1RUQ1RHR0FBVFRBR0FHR0FDQUFUQVRUQUFUQUFUQUNDQVRDR0NBQ0FHVEdUVFRDVFRUR1RUR1RUQUFUR0NUQUNBQUNBVEFDQUFBR0FHR0FBR0NBVEdDQUciCm15X2RuYQpsZW5ndGgobXlfZG5hKQpjbGFzcyhteV9kbmEpCnN0cihteV9kbmEpCm5jaGFyKG15X2RuYSkKYGBgCgpgYGB7ciBkbmFfZXgzLCBpbmNsdWRlID0gVCwgZWNobz1ULCBldmFsPVR9Cm15X2RuYV9saXN0IDwtIHN0cnNwbGl0KHggPSBteV9kbmEsIHNwbGl0ID0gIiIsIGZpeGVkID0gVFJVRSkKbGVuZ3RoKG15X2RuYV9saXN0KQpjbGFzcyhteV9kbmFfbGlzdCkKbXlfZG5hX3ZlY3RvciA8LSB1bmxpc3QobXlfZG5hX2xpc3QpCmxlbmd0aChteV9kbmFfbGlzdFtbMV1dKQpzdHIobXlfZG5hX3ZlY3RvcikKbGVuZ3RoKG15X2RuYV92ZWN0b3IpCgojIHVuaXF1ZSBjaGFyYWN0ZXJzCnVuaXF1ZShteV9kbmFfdmVjdG9yKQoKIyBudW1iZXIgb2YgQXMKKG15X2RuYV92ZWN0b3IgPT0gIkEiKQpsZW5ndGgobXlfZG5hX3ZlY3RvcltteV9kbmFfdmVjdG9yID09ICJBIl0pCgpgYGAKCgojIyBGcmVxdWVuY3kgZGlzdHJpYnV0aW9uCkEgZ2VuZSBjb25zaXN0cyBvZiBhIHNlcXVlbmNlIG9mIG51Y2xlb3RpZGVzIHtBLCBDLCBHLCBUfS5UaGUgbnVtYmVyIG9mIGVhY2ggbnVjbGVvdGlkZSBjYW4gYmUgZGlzcGxheWVkIGluIGEgZnJlcXVlbmN5IHRhYmxlLiBUaGlzIHdpbGwgYmUgaWxsdXN0cmF0ZWQgYnkgdGhlIFp5eGluIGdlbmUgd2hpY2ggcGxheXMgYW4gaW1wb3J0YW50IHJvbGUgaW4gY2VsbCBhZGhlc2lvbiAoR29sdWIgZXQgYWwuLCAxOTk5KS4gIFRoZSBhY2Nlc3Npb24gbnVtYmVyIChYOTQ5OTEuMSkgb2Ygb25lb2YgaXRzIHZhcmlhbnRzIGNhbiBiZSBmb3VuZCB2aWEgYW4gTkNCSSBVbmlHZW5lIHNlYXJjaC4gVGhlIGNvZGUgYmVsb3cgaWxsdXN0cmF0ZXMgaG93IHRvIGluc3RhbGwgdGhlIHBhY2thZ2UgYXBlLCB0byBsb2FkIGl0LCB0byByZWFkIGdlbmUg4oCdWDk0OTkxLjHigJ1vZiB0aGUgc3BlY2llcyBob21vIHNhcGllbnMgZnJvbSBHZW5CYW5rLCBhbmQgdG8gbWFrZSBhIGZyZXF1ZW5jeSB0YWJsZSBvZiB0aGUgZm91ciBudWNsZW90aWRlcwoKYGBge3IgZnJlcTEsIGluY2x1ZGUgPSBULCBlY2hvPVQsIGV2YWw9VH0KaW5zdGFsbC5wYWNrYWdlcyhjKCJhcGUiKSwgcmVwbz0iaHR0cDovL2NyYW4uci1wcm9qZWN0Lm9yZyIsIGRlcD1UUlVFKQpsaWJyYXJ5KGFwZSkKZ2VuZSA8LSByZWFkLkdlbkJhbmsoYygiWDk0OTkxLjEiKSwgIGFzLmNoYXJhY3Rlcj1UUlVFKQp0YWJsZShnZW5lKQpwaWUodGFibGUoZ2VuZSkpCmBgYAojIFByb2JhYmlsaXR5IGFuZCBTdGF0aXN0aWNzIGluIGBSYAoKIyMgUHJvYmFiaWxpdHkgaW4gYFJgCgojIyMgRGlzdHJpYnV0aW9ucwoKV2hlbiB3b3JraW5nIHdpdGggZGlmZmVyZW50IHN0YXRpc3RpY2FsIGRpc3RyaWJ1dGlvbnMsIHdlIG9mdGVuIHdhbnQgdG8gbWFrZSBwcm9iYWJpbGlzdGljIHN0YXRlbWVudHMgYmFzZWQgb24gdGhlIGRpc3RyaWJ1dGlvbi4KCldlIHR5cGljYWxseSB3YW50IHRvIGtub3cgb25lIG9mIGZvdXIgdGhpbmdzOgoKKiBUaGUgZGVuc2l0eSAocGRmKSBhdCBhIHBhcnRpY3VsYXIgdmFsdWUuCiogVGhlIGRpc3RyaWJ1dGlvbiAoY2RmKSBhdCBhIHBhcnRpY3VsYXIgdmFsdWUuCiogVGhlIHF1YW50aWxlIHZhbHVlIGNvcnJlc3BvbmRpbmcgdG8gYSBwYXJ0aWN1bGFyIHByb2JhYmlsaXR5LgoqIEEgcmFuZG9tIGRyYXcgb2YgdmFsdWVzIGZyb20gYSBwYXJ0aWN1bGFyIGRpc3RyaWJ1dGlvbi4KClRoaXMgdXNlZCB0byBiZSBkb25lIHdpdGggc3RhdGlzdGljYWwgdGFibGVzIHByaW50ZWQgaW4gdGhlIGJhY2sgb2YgdGV4dGJvb2tzLiBOb3csIGBSYCBoYXMgZnVuY3Rpb25zIGZvciBvYnRhaW5pbmcgZGVuc2l0eSwgZGlzdHJpYnV0aW9uLCBxdWFudGlsZSBhbmQgcmFuZG9tIHZhbHVlcy4KClRoZSBnZW5lcmFsIG5hbWluZyBzdHJ1Y3R1cmUgb2YgdGhlIHJlbGV2YW50IGBSYCBmdW5jdGlvbnMgaXM6CgoqIGBkbmFtZWAgY2FsY3VsYXRlcyBkZW5zaXR5IChwZGYpIGF0IGlucHV0IGB4YC4KKiBgcG5hbWVgIGNhbGN1bGF0ZXMgZGlzdHJpYnV0aW9uIChjZGYpIGF0IGlucHV0IGB4YC4KKiBgcW5hbWVgIGNhbGN1bGF0ZXMgdGhlIHF1YW50aWxlIGF0IGFuIGlucHV0IHByb2JhYmlsaXR5LgoqIGBybmFtZWAgZ2VuZXJhdGVzIGEgcmFuZG9tIGRyYXcgZnJvbSBhIHBhcnRpY3VsYXIgZGlzdHJpYnV0aW9uLgoKTm90ZSB0aGF0IGBuYW1lYCByZXByZXNlbnRzIHRoZSBuYW1lIG9mIHRoZSBnaXZlbiBkaXN0cmlidXRpb24uCgpGb3IgZXhhbXBsZSwgY29uc2lkZXIgYSByYW5kb20gdmFyaWFibGUgJFgkIHdoaWNoIGlzICROKFxtdSA9IDIsIFxzaWdtYV4yID0gMjUpJC4gKE5vdGUsIHdlIGFyZSBwYXJhbWV0ZXJpemluZyB1c2luZyB0aGUgdmFyaWFuY2UgJFxzaWdtYV4yJC4gYFJgIGhvd2V2ZXIgdXNlcyB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uLikKClRvIGNhbGN1bGF0ZSB0aGUgdmFsdWUgb2YgdGhlIHBkZiBhdCBgeCA9IDNgLCB0aGF0IGlzLCB0aGUgaGVpZ2h0IG9mIHRoZSBjdXJ2ZSBhdCBgeCA9IDNgLCB1c2U6CgpgYGB7cn0KZG5vcm0oeCA9IDMsIG1lYW4gPSAyLCBzZCA9IDUpCmBgYAoKVG8gY2FsY3VsYXRlIHRoZSB2YWx1ZSBvZiB0aGUgY2RmIGF0IGB4ID0gM2AsIHRoYXQgaXMsICRQKFggXGxlcSAzKSQsIHRoZSBwcm9iYWJpbGl0eSB0aGF0ICRYJCBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gYDNgLCB1c2U6CgpgYGB7cn0KcG5vcm0ocSA9IDMsIG1lYW4gPSAyLCBzZCA9IDUpCmBgYAoKT3IsIHRvIGNhbGN1bGF0ZSB0aGUgcXVhbnRpbGUgZm9yIHByb2JhYmlsaXR5IDAuOTc1LCB1c2U6CgpgYGB7cn0KcW5vcm0ocCA9IDAuOTc1LCBtZWFuID0gMiwgc2QgPSA1KQpgYGAKCkxhc3RseSwgdG8gZ2VuZXJhdGUgYSByYW5kb20gc2FtcGxlIG9mIHNpemUgYG4gPSAxMGAsIHVzZToKCmBgYHtyfQpybm9ybShuID0gMTAsIG1lYW4gPSAyLCBzZCA9IDUpCmBgYAoKVGhlc2UgZnVuY3Rpb25zIGV4aXN0IGZvciBtYW55IG90aGVyIGRpc3RyaWJ1dGlvbnMsIGluY2x1ZGluZyBidXQgbm90IGxpbWl0ZWQgdG86Cgp8IENvbW1hbmQgIHwgRGlzdHJpYnV0aW9uIHwKfC0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18CnwgYCpiaW5vbWAgfCBCaW5vbWlhbCAgICAgfAp8IGAqdGAgICAgIHwgdCAgICAgICAgICAgIHwKfCBgKnBvaXNgICB8IFBvaXNzb24gICAgICB8CnwgYCpmYCAgICAgfCBGICAgICAgICAgICAgfAp8IGAqY2hpc3FgIHwgQ2hpLVNxdWFyZWQgIHwKCldoZXJlIGAqYCBjYW4gYmUgYGRgLCBgcGAsIGBxYCwgYW5kIGByYC4gRWFjaCBkaXN0cmlidXRpb24gd2lsbCBoYXZlIGl0cyBvd24gc2V0IG9mIHBhcmFtZXRlcnMgd2hpY2ggbmVlZCB0byBiZSBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9ucyBhcyBhcmd1bWVudHMuIEZvciBleGFtcGxlLCBgZGJpbm9tKClgIHdvdWxkIG5vdCBoYXZlIGFyZ3VtZW50cyBmb3IgYG1lYW5gIGFuZCBgc2RgLCBzaW5jZSB0aG9zZSBhcmUgbm90IHBhcmFtZXRlcnMgb2YgdGhlIGRpc3RyaWJ1dGlvbi4gSW5zdGVhZCBhIGJpbm9taWFsIGRpc3RyaWJ1dGlvbiBpcyB1c3VhbGx5IHBhcmFtZXRlcml6ZWQgYnkgJG4kIGFuZCAkcCQsIGhvd2V2ZXIgYFJgIGNob29zZXMgdG8gY2FsbCB0aGVtIHNvbWV0aGluZyBlbHNlLiBUbyBmaW5kIHRoZSBuYW1lcyB0aGF0IGBSYCB1c2VzIHdlIHdvdWxkIHVzZSBgP2RiaW5vbWAgYW5kIHNlZSB0aGF0IGBSYCBpbnN0ZWFkIGNhbGxzIHRoZSBhcmd1bWVudHMgYHNpemVgIGFuZCBgcHJvYmAuIEZvciBleGFtcGxlOgoKYGBge3J9CmRiaW5vbSh4ID0gNiwgc2l6ZSA9IDEwLCBwcm9iID0gMC43NSkKYGBgCgpBbHNvIG5vdGUgdGhhdCwgd2hlbiB1c2luZyB0aGUgYGRuYW1lYCBmdW5jdGlvbnMgd2l0aCBkaXNjcmV0ZSBkaXN0cmlidXRpb25zLCB0aGV5IGFyZSB0aGUgcG1mIG9mIHRoZSBkaXN0cmlidXRpb24uIEZvciBleGFtcGxlLCB0aGUgYWJvdmUgY29tbWFuZCBpcyAkUChZID0gNikkIGlmICRZIFxzaW0gYihuID0gMTAsIHAgPSAwLjc1KSQuIChUaGUgcHJvYmFiaWxpdHkgb2YgZmxpcHBpbmcgYW4gdW5mYWlyIGNvaW4gYDEwYCB0aW1lcyBhbmQgc2VlaW5nIGA2YCBoZWFkcywgaWYgdGhlIHByb2JhYmlsaXR5IG9mIGhlYWRzIGlzIGAwLjc1YC4pCgojIyBIeXBvdGhlc2lzIFRlc3RzIGluIGBSYAoKQSBwcmVyZXF1aXNpdGUgZm9yIFNUQVQgNDIwIGlzIGFuIHVuZGVyc3RhbmRpbmcgb2YgdGhlIGJhc2ljcyBvZiBoeXBvdGhlc2lzIHRlc3RpbmcuIFJlY2FsbCB0aGUgYmFzaWMgc3RydWN0dXJlIG9mIGh5cG90aGVzaXMgdGVzdHM6CgotIEFuIG92ZXJhbGwgbW9kZWwgYW5kIHJlbGF0ZWQgYXNzdW1wdGlvbnMgYXJlIG1hZGUuIChUaGUgbW9zdCBjb21tb24gYmVpbmcgb2JzZXJ2YXRpb25zIGZvbGxvd2luZyBhIG5vcm1hbCBkaXN0cmlidXRpb24uKQotIFRoZSAqKm51bGwqKiAoJEhfezB9JCkgYW5kICoqYWx0ZXJuYXRpdmUqKiAoJEhfezF9JCBvciAkSF97QX0kKSBoeXBvdGhlc2lzIGFyZSBzcGVjaWZpZWQuIFVzdWFsbHkgdGhlIG51bGwgc3BlY2lmaWVzIGEgcGFydGljdWxhciB2YWx1ZSBvZiBhIHBhcmFtZXRlci4KLSBXaXRoIGdpdmVuIGRhdGEsIHRoZSAqKnZhbHVlKiogb2YgdGhlICp0ZXN0IHN0YXRpc3RpYyogaXMgY2FsY3VsYXRlZC4KLSBVbmRlciB0aGUgZ2VuZXJhbCBhc3N1bXB0aW9ucywgYXMgd2VsbCBhcyBhc3N1bWluZyB0aGUgbnVsbCBoeXBvdGhlc2lzIGlzIHRydWUsIHRoZSAqKmRpc3RyaWJ1dGlvbioqIG9mIHRoZSAqdGVzdCBzdGF0aXN0aWMqIGlzIGtub3duLgotIEdpdmVuIHRoZSBkaXN0cmlidXRpb24gYW5kIHZhbHVlIG9mIHRoZSB0ZXN0IHN0YXRpc3RpYywgYXMgd2VsbCBhcyB0aGUgZm9ybSBvZiB0aGUgYWx0ZXJuYXRpdmUgaHlwb3RoZXNpcywgd2UgY2FuIGNhbGN1bGF0ZSBhICoqcC12YWx1ZSoqIG9mIHRoZSB0ZXN0LgotIEJhc2VkIG9uIHRoZSAqKnAtdmFsdWUqKiBhbmQgcHJlLXNwZWNpZmllZCBsZXZlbCBvZiBzaWduaWZpY2FuY2UsIHdlIG1ha2UgYSBkZWNpc2lvbi4gT25lIG9mOgogICAgLSBGYWlsIHRvIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzLgogICAgLSBSZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcy4KICAgIApXZSdsbCBkbyBzb21lIHF1aWNrIHJldmlldyBvZiB0d28gb2YgdGhlIG1vc3QgY29tbW9uIHRlc3RzIHRvIHNob3cgaG93IHRoZXkgYXJlIHBlcmZvcm1lZCB1c2luZyBgUmAuCgojIyMgT25lIFNhbXBsZSB0LVRlc3Q6IFJldmlldwoKU3VwcG9zZSAkeF97aX0gXHNpbSBcbWF0aHJte059KFxtdSxcc2lnbWFeezJ9KSQgYW5kIHdlIHdhbnQgdG8gdGVzdCAkSF97MH06IFxtdSA9IFxtdV97MH0kIHZlcnN1cyAkSF97MX06IFxtdSBcbmVxIFxtdV97MH0uJAoKQXNzdW1pbmcgJFxzaWdtYSQgaXMgdW5rbm93biwgd2UgdXNlIHRoZSBvbmUtc2FtcGxlIFN0dWRlbnQncyAkdCQgdGVzdCBzdGF0aXN0aWM6CgpcWwp0ID0gXGZyYWN7XGJhcnt4fS1cbXVfezB9fXtzL1xzcXJ0e259fSBcc2ltIHRfe24tMX0sClxdCgp3aGVyZSAkXGJhcnt4fSA9IFxkaXNwbGF5c3R5bGVcZnJhY3tcc3VtX3tpPTF9XntufXhfe2l9fXtufSQgYW5kICRzID0gXHNxcnR7XGRpc3BsYXlzdHlsZVxmcmFjezF9e24gLSAxfVxzdW1fe2k9MX1ee259KHhfaSAtIFxiYXJ7eH0pXjJ9JC4KCkEgJDEwMCgxIC0gXGFscGhhKSRcJSBjb25maWRlbmNlIGludGVydmFsIGZvciAkXG11JCBpcyBnaXZlbiBieSwKClxbClxiYXJ7eH0gXHBtIHRfe24tMX0oXGFscGhhLzIpXGZyYWN7c317XHNxcnR7bn19ClxdCgp3aGVyZSAkdF97bi0xfShcYWxwaGEvMikkIGlzIHRoZSBjcml0aWNhbCB2YWx1ZSBzdWNoIHRoYXQgJFBcbGVmdCh0PnRfe24tMX0oXGFscGhhLzIpXHJpZ2h0KSA9IFxhbHBoYS8yJCBmb3IgJG4tMSQgZGVncmVlcyBvZiBmcmVlZG9tLgoKIyMjIE9uZSBTYW1wbGUgdC1UZXN0OiBFeGFtcGxlCgpTdXBwb3NlIGEgZ3JvY2VyeSBzdG9yZSBzZWxscyAiMTYgb3VuY2UiIGJveGVzIG9mICpDYXB0YWluIENyaXNwKiBjZXJlYWwuIEEgcmFuZG9tIHNhbXBsZSBvZiA5IGJveGVzIHdhcyB0YWtlbiBhbmQgd2VpZ2hlZC4gVGhlIHdlaWdodCBpbiBvdW5jZXMgYXJlIHN0b3JlZCBpbiB0aGUgZGF0YSBmcmFtZSBgY2FwdF9jcmlzcGAuCgpgYGB7cn0KY2FwdF9jcmlzcCA9IGRhdGEuZnJhbWUod2VpZ2h0ID0gYygxNS41LCAxNi4yLCAxNi4xLCAxNS44LCAxNS42LCAxNi4wLCAxNS44LCAxNS45LCAxNi4yKSkKYGBgCgpUaGUgY29tcGFueSB0aGF0IG1ha2VzICpDYXB0YWluIENyaXNwKiBjZXJlYWwgY2xhaW1zIHRoYXQgdGhlIGF2ZXJhZ2Ugd2VpZ2h0IG9mIGEgYm94IGlzIGF0IGxlYXN0IDE2IG91bmNlcy4gV2Ugd2lsbCBhc3N1bWUgdGhlIHdlaWdodCBvZiBjZXJlYWwgaW4gYSBib3ggaXMgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgYW5kIHVzZSBhIDAuMDUgbGV2ZWwgb2Ygc2lnbmlmaWNhbmNlIHRvIHRlc3QgdGhlIGNvbXBhbnkncyBjbGFpbS4KClRvIHRlc3QgJEhfezB9OiBcbXUgXGdlcSAxNiQgdmVyc3VzICRIX3sxfTogXG11IDwgMTYkLCB0aGUgdGVzdCBzdGF0aXN0aWMgaXMKClxbCnQgPSBcZnJhY3tcYmFye3h9IC0gXG11X3swfX17cyAvIFxzcXJ0e259fQpcXQoKVGhlIHNhbXBsZSBtZWFuICRcYmFye3h9JCBhbmQgdGhlIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb24gJHMkIGNhbiBiZSBlYXNpbHkgY29tcHV0ZWQgdXNpbmcgYFJgLiBXZSBhbHNvIGNyZWF0ZSB2YXJpYWJsZXMgd2hpY2ggc3RvcmUgdGhlIGh5cG90aGVzaXplZCBtZWFuIGFuZCB0aGUgc2FtcGxlIHNpemUuCgpgYGB7cn0KeF9iYXIgPSBtZWFuKGNhcHRfY3Jpc3Akd2VpZ2h0KQpzICAgICA9IHNkKGNhcHRfY3Jpc3Akd2VpZ2h0KQptdV8wICA9IDE2Cm4gICAgID0gOQpgYGAKCldlIGNhbiB0aGVuIGVhc2lseSBjb21wdXRlIHRoZSB0ZXN0IHN0YXRpc3RpYy4KCmBgYHtyfQp0ID0gKHhfYmFyIC0gbXVfMCkgLyAocyAvIHNxcnQobikpCnQKYGBgCgpVbmRlciB0aGUgbnVsbCBoeXBvdGhlc2lzLCB0aGUgdGVzdCBzdGF0aXN0aWMgaGFzIGEgJHQkIGRpc3RyaWJ1dGlvbiB3aXRoICRuIC0gMSQgZGVncmVlcyBvZiBmcmVlZG9tLCBpbiB0aGlzIGNhc2UgYHIgbiAtIDFgLgoKVG8gY29tcGxldGUgdGhlIHRlc3QsIHdlIG5lZWQgdG8gb2J0YWluIHRoZSBwLXZhbHVlIG9mIHRoZSB0ZXN0LiBTaW5jZSB0aGlzIGlzIGEgb25lLXNpZGVkIHRlc3Qgd2l0aCBhIGxlc3MtdGhhbiBhbHRlcm5hdGl2ZSwgd2UgbmVlZCB0aGUgYXJlYSB0byB0aGUgbGVmdCBvZiBgciB0YCBmb3IgYSAkdCQgZGlzdHJpYnV0aW9uIHdpdGggYHIgbiAtIDFgIGRlZ3JlZXMgb2YgZnJlZWRvbS4gVGhhdCBpcywKClxbClAodF97YHIgbiAtIDFgfSA8IGByIHRgKQpcXQoKYGBge3J9CnB0KHQsIGRmID0gbiAtIDEpCmBgYAoKV2Ugbm93IGhhdmUgdGhlIHAtdmFsdWUgb2Ygb3VyIHRlc3QsIHdoaWNoIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc2lnbmlmaWNhbmNlIGxldmVsICgwLjA1KSwgc28gd2UgZmFpbCB0byByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcy4KCkFsdGVybmF0aXZlbHksIHRoaXMgZW50aXJlIHByb2Nlc3MgY291bGQgaGF2ZSBiZWVuIGNvbXBsZXRlZCB1c2luZyBvbmUgbGluZSBvZiBgUmAgY29kZS4KCmBgYHtyfQp0LnRlc3QoeCA9IGNhcHRfY3Jpc3Akd2VpZ2h0LCBtdSA9IDE2LCBhbHRlcm5hdGl2ZSA9IGMoImxlc3MiKSwgY29uZi5sZXZlbCA9IDAuOTUpCmBgYAoKV2Ugc3VwcGx5IGBSYCB3aXRoIHRoZSBkYXRhLCB0aGUgaHlwb3RoZXNpemVkIHZhbHVlIG9mICRcbXUkLCB0aGUgYWx0ZXJuYXRpdmUsIGFuZCB0aGUgY29uZmlkZW5jZSBsZXZlbC4gYFJgIHRoZW4gcmV0dXJucyBhIHdlYWx0aCBvZiBpbmZvcm1hdGlvbiBpbmNsdWRpbmc6CgotIFRoZSB2YWx1ZSBvZiB0aGUgdGVzdCBzdGF0aXN0aWMuCi0gVGhlIGRlZ3JlZXMgb2YgZnJlZWRvbSBvZiB0aGUgZGlzdHJpYnV0aW9uIHVuZGVyIHRoZSBudWxsIGh5cG90aGVzaXMuCi0gVGhlIHAtdmFsdWUgb2YgdGhlIHRlc3QuCi0gVGhlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgd2hpY2ggY29ycmVzcG9uZHMgdG8gdGhlIHRlc3QuCi0gQW4gZXN0aW1hdGUgb2YgJFxtdSQuCgpTaW5jZSB0aGUgdGVzdCB3YXMgb25lLXNpZGVkLCBgUmAgcmV0dXJuZWQgYSBvbmUtc2lkZWQgY29uZmlkZW5jZSBpbnRlcnZhbC4gSWYgaW5zdGVhZCB3ZSB3YW50ZWQgYSB0d28tc2lkZWQgaW50ZXJ2YWwgZm9yIHRoZSBtZWFuIHdlaWdodCBvZiBib3hlcyBvZiAqQ2FwdGFpbiBDcmlzcCogY2VyZWFsIHdlIGNvdWxkIG1vZGlmeSBvdXIgY29kZS4KCmBgYHtyfQpjYXB0X3Rlc3RfcmVzdWx0cyA9IHQudGVzdChjYXB0X2NyaXNwJHdlaWdodCwgbXUgPSAxNiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0ZXJuYXRpdmUgPSBjKCJ0d28uc2lkZWQiKSwgY29uZi5sZXZlbCA9IDAuOTUpCmBgYAoKVGhpcyB0aW1lIHdlIGhhdmUgc3RvcmVkIHRoZSByZXN1bHRzLiBCeSBkb2luZyBzbywgd2UgY2FuIGRpcmVjdGx5IGFjY2VzcyBwb3J0aW9ucyBvZiB0aGUgb3V0cHV0IGZyb20gYHQudGVzdCgpYC4gVG8gc2VlIHdoYXQgaW5mb3JtYXRpb24gaXMgYXZhaWxhYmxlIHdlIHVzZSB0aGUgYG5hbWVzKClgIGZ1bmN0aW9uLgoKYGBge3J9Cm5hbWVzKGNhcHRfdGVzdF9yZXN1bHRzKQpgYGAKCldlIGFyZSBpbnRlcmVzdGVkIGluIHRoZSBjb25maWRlbmNlIGludGVydmFsIHdoaWNoIGlzIHN0b3JlZCBpbiBgY29uZi5pbnRgLgoKYGBge3J9CmNhcHRfdGVzdF9yZXN1bHRzJGNvbmYuaW50CmBgYAoKTGV0J3MgY2hlY2sgdGhpcyBpbnRlcnZhbCAiYnkgaGFuZC4iIFRoZSBvbmUgcGllY2Ugb2YgaW5mb3JtYXRpb24gd2UgYXJlIG1pc3NpbmcgaXMgdGhlIGNyaXRpY2FsIHZhbHVlLCAkdF97bi0xfShcYWxwaGEvMikgPSB0X3s4fSgwLjAyNSkkLCB3aGljaCBjYW4gYmUgY2FsY3VsYXRlZCBpbiBgUmAgdXNpbmcgdGhlIGBxdCgpYCBmdW5jdGlvbi4KCmBgYHtyfQpxdCgwLjk3NSwgZGYgPSA4KQpgYGAKClNvLCB0aGUgOTVcJSBDSSBmb3IgdGhlIG1lYW4gd2VpZ2h0IG9mIGEgY2VyZWFsIGJveCBpcyBjYWxjdWxhdGVkIGJ5IHBsdWdnaW5nIGludG8gdGhlIGZvcm11bGEsCgpcWwpcYmFye3h9IFxwbSB0X3tuLTF9KFxhbHBoYS8yKSBcZnJhY3tzfXtcc3FydHtufX0KXF0KCmBgYHtyfQpjKG1lYW4oY2FwdF9jcmlzcCR3ZWlnaHQpIC0gcXQoMC45NzUsIGRmID0gOCkgKiBzZChjYXB0X2NyaXNwJHdlaWdodCkgLyBzcXJ0KDkpLAogIG1lYW4oY2FwdF9jcmlzcCR3ZWlnaHQpICsgcXQoMC45NzUsIGRmID0gOCkgKiBzZChjYXB0X2NyaXNwJHdlaWdodCkgLyBzcXJ0KDkpKQpgYGAKCiMjIyBUd28gU2FtcGxlIHQtVGVzdDogUmV2aWV3CgpTdXBwb3NlICR4X3tpfSBcc2ltIFxtYXRocm17Tn0oXG11X3t4fSwgXHNpZ21hXnsyfSkkIGFuZCAkeV97aX0gXHNpbSBcbWF0aHJte059KFxtdV97eX0sIFxzaWdtYV57Mn0pLiQgCgpXYW50IHRvIHRlc3QgJEhfezB9OiBcbXVfe3h9IC0gXG11X3t5fSA9IFxtdV97MH0kIHZlcnN1cyAkSF97MX06IFxtdV97eH0gLSBcbXVfe3l9IFxuZXEgXG11X3swfS4kCgpBc3N1bWluZyAkXHNpZ21hJCBpcyB1bmtub3duLCB1c2UgdGhlIHR3by1zYW1wbGUgU3R1ZGVudCdzICR0JCB0ZXN0IHN0YXRpc3RpYzoKClxbCnQgPSBcZnJhY3soXGJhcnt4fSAtIFxiYXJ7eX0pLVxtdV97MH19e3Nfe3B9XHNxcnR7XGZyYWN7MX17bn0rXGZyYWN7MX17bX19fSBcc2ltIHRfe24rbS0yfSwKXF0KCndoZXJlICRcZGlzcGxheXN0eWxlXGJhcnt4fT1cZnJhY3tcc3VtX3tpPTF9XntufXhfe2l9fXtufSQsICRcZGlzcGxheXN0eWxlXGJhcnt5fT1cZnJhY3tcc3VtX3tpPTF9XnttfXlfe2l9fXttfSQsIGFuZCAkc19wXjIgPSBcZGlzcGxheXN0eWxlXGZyYWN7KG4tMSlzX3heMisobS0xKXNfeV4yfXtuK20tMn0kLgoKQSAkMTAwKDEtXGFscGhhKSRcJSBDSSBmb3IgJFxtdV97eH0tXG11X3t5fSQgaXMgZ2l2ZW4gYnkKClxbCihcYmFye3h9IC0gXGJhcnt5fSkgXHBtIHRfe24rbS0yfShcYWxwaGEvMikgXGxlZnQoc197cH1cdGV4dHN0eWxlXHNxcnR7XGZyYWN7MX17bn0rXGZyYWN7MX17bX19XHJpZ2h0KSwKXF0KCndoZXJlICR0X3tuK20tMn0oXGFscGhhLzIpJCBpcyB0aGUgY3JpdGljYWwgdmFsdWUgc3VjaCB0aGF0ICRQXGxlZnQodD50X3tuK20tMn0oXGFscGhhLzIpXHJpZ2h0KT1cYWxwaGEvMiQuCgojIyMgVHdvIFNhbXBsZSB0LVRlc3Q6IEV4YW1wbGUKCkFzc3VtZSB0aGF0IHRoZSBkaXN0cmlidXRpb25zIG9mICRYJCBhbmQgJFkkIGFyZSAkXG1hdGhybXtOfShcbXVfezF9LFxzaWdtYV57Mn0pJCBhbmQgJFxtYXRocm17Tn0oXG11X3syfSxcc2lnbWFeezJ9KSQsIHJlc3BlY3RpdmVseS4gR2l2ZW4gdGhlICRuID0gNiQgb2JzZXJ2YXRpb25zIG9mICRYJCwKCmBgYHtyfQp4ID0gYyg3MCwgODIsIDc4LCA3NCwgOTQsIDgyKQpuID0gbGVuZ3RoKHgpCmBgYAoKYW5kIHRoZSAkbSA9IDgkIG9ic2VydmF0aW9ucyBvZiAkWSQsCgpgYGB7cn0KeSA9IGMoNjQsIDcyLCA2MCwgNzYsIDcyLCA4MCwgODQsIDY4KQptID0gbGVuZ3RoKHkpCmBgYAoKd2Ugd2lsbCB0ZXN0ICRIX3swfTogXG11X3sxfSA9IFxtdV97Mn0kIHZlcnN1cyAkSF97MX06IFxtdV97MX0gPiBcbXVfezJ9JC4KCkZpcnN0LCBub3RlIHRoYXQgd2UgY2FuIGNhbGN1bGF0ZSB0aGUgc2FtcGxlIG1lYW5zIGFuZCBzdGFuZGFyZCBkZXZpYXRpb25zLgoKYGBge3J9CnhfYmFyID0gbWVhbih4KQpzX3ggICA9IHNkKHgpCnlfYmFyID0gbWVhbih5KQpzX3kgICA9IHNkKHkpCmBgYAoKV2UgY2FuIHRoZW4gY2FsY3VsYXRlIHRoZSBwb29sZWQgc3RhbmRhcmQgZGV2aWF0aW9uLgoKXFsKc197cH0gPSBcc3FydHtcZnJhY3sobi0xKXNfe3h9XnsyfSsobS0xKXNfe3l9XnsyfX17bittLTJ9fQpcXQoKYGBge3J9CnNfcCA9IHNxcnQoKChuIC0gMSkgKiBzX3ggXiAyICsgKG0gLSAxKSAqIHNfeSBeIDIpIC8gKG4gKyBtIC0gMikpCmBgYAoKVGh1cywgdGhlIHJlbGV2YW50ICR0JCB0ZXN0IHN0YXRpc3RpYyBpcyBnaXZlbiBieQoKXFsKdCA9IFxmcmFjeyhcYmFye3h9LVxiYXJ7eX0pLVxtdV97MH19e3Nfe3B9XHNxcnR7XGZyYWN7MX17bn0rXGZyYWN7MX17bX19fS4KXF0KCmBgYHtyfQp0ID0gKCh4X2JhciAtIHlfYmFyKSAtIDApIC8gKHNfcCAqIHNxcnQoMSAvIG4gKyAxIC8gbSkpCnQKYGBgCgpOb3RlIHRoYXQgJHQgXHNpbSB0X3tuICsgbSAtIDJ9ID0gdF97YHIgbiArIG0gLSAyYH0kLCBzbyB3ZSBjYW4gY2FsY3VsYXRlIHRoZSBwLXZhbHVlLCB3aGljaCBpcwoKXFsKUCh0X3tgciBuICsgbSAtIDJgfSA+IGByIHRgKS4KXF0KCmBgYHtyfQoxIC0gcHQodCwgZGYgPSBuICsgbSAtIDIpCmBgYAoKQnV0LCB0aGVuIGFnYWluLCB3ZSBjb3VsZCBoYXZlIHNpbXBseSBwZXJmb3JtZWQgdGhpcyB0ZXN0IGluIG9uZSBsaW5lIG9mIGBSYC4KCmBgYHtyfQp0LnRlc3QoeCwgeSwgYWx0ZXJuYXRpdmUgPSBjKCJncmVhdGVyIiksIHZhci5lcXVhbCA9IFRSVUUpCmBgYAoKUmVjYWxsIHRoYXQgYSB0d28tc2FtcGxlICR0JC10ZXN0IGNhbiBiZSBkb25lIHdpdGggb3Igd2l0aG91dCBhbiBlcXVhbCB2YXJpYW5jZSBhc3N1bXB0aW9uLiBIZXJlIGB2YXIuZXF1YWwgPSBUUlVFYCB0ZWxscyBgUmAgd2Ugd291bGQgbGlrZSB0byBwZXJmb3JtIHRoZSB0ZXN0IHVuZGVyIHRoZSBlcXVhbCB2YXJpYW5jZSBhc3N1bXB0aW9uLgoKQWJvdmUgd2UgY2FycmllZCBvdXQgdGhlIGFuYWx5c2lzIHVzaW5nIHR3byB2ZWN0b3JzIGB4YCBhbmQgYHlgLiBJbiBnZW5lcmFsLCB3ZSB3aWxsIGhhdmUgYSBwcmVmZXJlbmNlIGZvciB1c2luZyBkYXRhIGZyYW1lcy4KCmBgYHtyfQp0X3Rlc3RfZGF0YSA9IGRhdGEuZnJhbWUodmFsdWVzID0gYyh4LCB5KSwKICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwICA9IGMocmVwKCJBIiwgbGVuZ3RoKHgpKSwgcmVwKCJCIiwgbGVuZ3RoKHkpKSkpCmBgYAoKV2Ugbm93IGhhdmUgdGhlIGRhdGEgc3RvcmVkIGluIGEgc2luZ2xlIHZhcmlhYmxlcyAoYHZhbHVlc2ApIGFuZCBoYXZlIGNyZWF0ZWQgYSBzZWNvbmQgdmFyaWFibGUgKGBncm91cGApIHdoaWNoIGluZGljYXRlcyB3aGljaCAic2FtcGxlIiB0aGUgdmFsdWUgYmVsb25ncyB0by4KCmBgYHtyfQp0X3Rlc3RfZGF0YQpgYGAKCk5vdyB0byBwZXJmb3JtIHRoZSB0ZXN0LCB3ZSBzdGlsbCB1c2UgdGhlIGB0LnRlc3QoKWAgZnVuY3Rpb24gYnV0IHdpdGggdGhlIGB+YCBzeW50YXggYW5kIGEgYGRhdGFgIGFyZ3VtZW50LgoKYGBge3J9CnQudGVzdCh2YWx1ZXMgfiBncm91cCwgZGF0YSA9IHRfdGVzdF9kYXRhLAogICAgICAgYWx0ZXJuYXRpdmUgPSBjKCJncmVhdGVyIiksIHZhci5lcXVhbCA9IFRSVUUpCmBgYAoKIyMgU2ltdWxhdGlvbgoKU2ltdWxhdGlvbiBhbmQgbW9kZWwgZml0dGluZyBhcmUgcmVsYXRlZCBidXQgb3Bwb3NpdGUgcHJvY2Vzc2VzLgoKLSBJbiAqKnNpbXVsYXRpb24qKiwgdGhlICpkYXRhIGdlbmVyYXRpbmcgcHJvY2VzcyogaXMga25vd24uIFdlIHdpbGwga25vdyB0aGUgZm9ybSBvZiB0aGUgbW9kZWwgYXMgd2VsbCBhcyB0aGUgdmFsdWUgb2YgZWFjaCBvZiB0aGUgcGFyYW1ldGVycy4gSW4gcGFydGljdWxhciwgd2Ugd2lsbCBvZnRlbiBjb250cm9sIHRoZSBkaXN0cmlidXRpb24gYW5kIHBhcmFtZXRlcnMgd2hpY2ggZGVmaW5lIHRoZSByYW5kb21uZXNzLCBvciBub2lzZSBpbiB0aGUgZGF0YS4KLSBJbiAqKm1vZGVsIGZpdHRpbmcqKiwgdGhlICpkYXRhKiBpcyBrbm93bi4gV2Ugd2lsbCB0aGVuIGFzc3VtZSBhIGNlcnRhaW4gZm9ybSBvZiBtb2RlbCBhbmQgZmluZCB0aGUgYmVzdCBwb3NzaWJsZSB2YWx1ZXMgb2YgdGhlIHBhcmFtZXRlcnMgZ2l2ZW4gdGhlIG9ic2VydmVkIGRhdGEuIEVzc2VudGlhbGx5IHdlIGFyZSBzZWVraW5nIHRvIHVuY292ZXIgdGhlIHRydXRoLiBPZnRlbiB3ZSB3aWxsIGF0dGVtcHQgdG8gZml0IG1hbnkgbW9kZWxzLCBhbmQgd2Ugd2lsbCBsZWFybiBtZXRyaWNzIHRvIGFzc2VzcyB3aGljaCBtb2RlbCBmaXRzIGJlc3QuCgohW1NpbXVsYXRpb24gdnMgTW9kZWxpbmddKGltYWdlcy9zaW11bGF0aW9uLnBuZykKCk9mdGVuIHdlIHdpbGwgc2ltdWxhdGUgZGF0YSBhY2NvcmRpbmcgdG8gYSBwcm9jZXNzIHdlIGRlY2lkZSwgdGhlbiB1c2UgYSBtb2RlbGluZyBtZXRob2Qgc2VlbiBpbiBjbGFzcy4gV2UgY2FuIHRoZW4gdmVyaWZ5IGhvdyB3ZWxsIHRoZSBtZXRob2Qgd29ya3MsIHNpbmNlIHdlIGtub3cgdGhlIGRhdGEgZ2VuZXJhdGluZyBwcm9jZXNzLgoKT25lIG9mIHRoZSBiaWdnZXN0IHN0cmVuZ3RocyBvZiBgUmAgaXMgaXRzIGFiaWxpdHkgdG8gY2Fycnkgb3V0IHNpbXVsYXRpb25zIHVzaW5nIGJ1aWx0LWluIGZ1bmN0aW9ucyBmb3IgZ2VuZXJhdGluZyByYW5kb20gc2FtcGxlcyBmcm9tIGNlcnRhaW4gZGlzdHJpYnV0aW9ucy4gV2UnbGwgbG9vayBhdCB0d28gdmVyeSBzaW1wbGUgZXhhbXBsZXMgaGVyZSwgaG93ZXZlciBzaW11bGF0aW9uIHdpbGwgYmUgYSB0b3BpYyB3ZSByZXZpc2l0IHNldmVyYWwgdGltZXMgdGhyb3VnaG91dCB0aGUgY291cnNlLgoKIyMjIFBhaXJlZCBEaWZmZXJlbmNlcwoKQ29uc2lkZXIgdGhlIG1vZGVsOgoKXFsKXGJlZ2lue3NwbGl0fQpYX3sxMX0sIFhfezEyfSwgXGxkb3RzLCBYX3sxbn0gXHNpbSBOKFxtdV8xLFxzaWdtYV4yKVxcClhfezIxfSwgWF97MjJ9LCBcbGRvdHMsIFhfezJufSBcc2ltIE4oXG11XzIsXHNpZ21hXjIpClxlbmR7c3BsaXR9ClxdCgpBc3N1bWUgdGhhdCAkXG11XzEgPSA2JCwgJFxtdV8yID0gNSQsICRcc2lnbWFeMiA9IDQkIGFuZCAkbiA9IDI1JC4KCkxldAoKXFsKXGJlZ2lue2FsaWduZWR9ClxiYXJ7WH1fMSAmPSBcZGlzcGxheXN0eWxlXGZyYWN7MX17bn1cc3VtX3tpPTF9XntufVhfezFpfVxcClxiYXJ7WH1fMiAmPSBcZGlzcGxheXN0eWxlXGZyYWN7MX17bn1cc3VtX3tpPTF9XntufVhfezJpfVxcCkQgJj0gXGJhcntYfV8xIC0gXGJhcntYfV8yLgpcZW5ke2FsaWduZWR9ClxdCgpTdXBwb3NlIHdlIHdvdWxkIGxpa2UgdG8gY2FsY3VsYXRlICRQKDAgPCBEIDwgMikkLiBGaXJzdCB3ZSB3aWxsIG5lZWQgdG8gb2J0YWluIHRoZSBkaXN0cmlidXRpb24gb2YgJEQkLgoKUmVjYWxsLAoKXFsKXGJhcntYfV8xIFxzaW0gTlxsZWZ0KFxtdV8xLFxmcmFje1xzaWdtYV4yfXtufVxyaWdodCkKXF0KCmFuZAoKXFsKXGJhcntYfV8yIFxzaW0gTlxsZWZ0KFxtdV8yLFxmcmFje1xzaWdtYV4yfXtufVxyaWdodCkuClxdCgpUaGVuLCAKClxbCkQgPSBcYmFye1h9XzEgLSBcYmFye1h9XzIgXHNpbSBOXGxlZnQoXG11XzEtXG11XzIsIFxmcmFje1xzaWdtYV4yfXtufSArIFxmcmFje1xzaWdtYV4yfXtufVxyaWdodCkgPSBOXGxlZnQoNi01LCBcZnJhY3s0fXsyNX0gKyBcZnJhY3s0fXsyNX1ccmlnaHQpLgpcXQoKU28sIAoKXFsKRCBcc2ltIE4oXG11ID0gMSwgXHNpZ21hXjIgPSAwLjMyKS4KXF0KClRodXMsCgpcWwpQKDAgPCBEIDwgMikgPSBQKEQgPCAyKSAtIFAoRCA8IDApLgpcXQoKVGhpcyBjYW4gdGhlbiBiZSBjYWxjdWxhdGVkIHVzaW5nIGBSYCB3aXRob3V0IGEgbmVlZCB0byBmaXJzdCBzdGFuZGFyZGl6ZSwgb3IgdXNlIGEgdGFibGUuCgpgYGB7cn0KcG5vcm0oMiwgbWVhbiA9IDEsIHNkID0gc3FydCgwLjMyKSkgLSBwbm9ybSgwLCBtZWFuID0gMSwgc2QgPSBzcXJ0KDAuMzIpKQpgYGAKCkFuIGFsdGVybmF0aXZlIGFwcHJvYWNoLCB3b3VsZCBiZSB0byAqKnNpbXVsYXRlKiogYSBsYXJnZSBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIG9mICREJCB0aGVuIHVzZSB0aGUgKiplbXBpcmljYWwgZGlzdHJpYnV0aW9uKiogdG8gY2FsY3VsYXRlIHRoZSBwcm9iYWJpbGl0eS4KCk91ciBzdHJhdGVneSB3aWxsIGJlIHRvIHJlcGVhdGVkbHk6CgotIEdlbmVyYXRlIGEgc2FtcGxlIG9mIDI1IHJhbmRvbSBvYnNlcnZhdGlvbnMgZnJvbSAkTihcbXVfMSA9IDYsXHNpZ21hXjIgPSA0KSQuIENhbGwgdGhlIG1lYW4gb2YgdGhpcyBzYW1wbGUgJFxiYXJ7eH1fezFzfSQuCi0gR2VuZXJhdGUgYSBzYW1wbGUgb2YgMjUgcmFuZG9tIG9ic2VydmF0aW9ucyBmcm9tICROKFxtdV8xID0gNSxcc2lnbWFeMiA9IDQpJC4gQ2FsbCB0aGUgbWVhbiBvZiB0aGlzIHNhbXBsZSAkXGJhcnt4fV97MnN9JC4KLSBDYWxjdWxhdGUgdGhlIGRpZmZlcmVuY2VzIG9mIHRoZSBtZWFucywgJGRfcyA9IFxiYXJ7eH1fezFzfSAtIFxiYXJ7eH1fezJzfSQuCgpXZSB3aWxsIHJlcGVhdCB0aGUgcHJvY2VzcyBhIGxhcmdlIG51bWJlciBvZiB0aW1lcy4gVGhlbiB3ZSB3aWxsIHVzZSB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBzaW11bGF0ZWQgb2JzZXJ2YXRpb25zIG9mICRkX3MkIGFzIGFuIGVzdGltYXRlIGZvciB0aGUgdHJ1ZSBkaXN0cmlidXRpb24gb2YgJEQkLgoKYGBge3J9CnNldC5zZWVkKDQyKQpudW1fc2FtcGxlcyA9IDEwMDAwCmRpZmZlcmVuY2VzID0gcmVwKDAsIG51bV9zYW1wbGVzKQpgYGAKCkJlZm9yZSBzdGFydGluZyBvdXIgYGZvcmAgbG9vcCB0byBwZXJmb3JtIHRoZSBvcGVyYXRpb24sIHdlIHNldCBhIHNlZWQgZm9yIHJlcHJvZHVjaWJpbGl0eSwgY3JlYXRlIGFuZCBzZXQgYSB2YXJpYWJsZSBgbnVtX3NhbXBsZXNgIHdoaWNoIHdpbGwgZGVmaW5lIHRoZSBudW1iZXIgb2YgcmVwZXRpdGlvbnMsIGFuZCBsYXN0bHkgY3JlYXRlIGEgdmFyaWFibGVzIGBkaWZmZXJlbmNlc2Agd2hpY2ggd2lsbCBzdG9yZSB0aGUgc2ltdWxhdGUgdmFsdWVzLCAkZF9zJC4KCkJ5IHVzaW5nIGBzZXQuc2VlZCgpYCB3ZSBjYW4gcmVwcm9kdWNlIHRoZSByYW5kb20gcmVzdWx0cyBvZiBgcm5vcm0oKWAgZWFjaCB0aW1lIHN0YXJ0aW5nIGZyb20gdGhhdCBsaW5lLiAKCmBgYHtyfQpmb3IgKHMgaW4gMTpudW1fc2FtcGxlcykgewogIHgxID0gcm5vcm0obiA9IDI1LCBtZWFuID0gNiwgc2QgPSAyKQogIHgyID0gcm5vcm0obiA9IDI1LCBtZWFuID0gNSwgc2QgPSAyKQogIGRpZmZlcmVuY2VzW3NdID0gbWVhbih4MSkgLSBtZWFuKHgyKQp9CmBgYAoKVG8gZXN0aW1hdGUgJFAoMCA8IEQgPCAyKSQgd2Ugd2lsbCBmaW5kIHRoZSBwcm9wb3J0aW9uIG9mIHZhbHVlcyBvZiAkZF9zJCAoYW1vbmcgdGhlIGByIG51bV9zYW1wbGVzYCB2YWx1ZXMgb2YgJGRfcyQgZ2VuZXJhdGVkKSB0aGF0IGFyZSBiZXR3ZWVuIDAgYW5kIDIuCgpgYGB7cn0KbWVhbigwIDwgZGlmZmVyZW5jZXMgJiBkaWZmZXJlbmNlcyA8IDIpCmBgYAoKUmVjYWxsIHRoYXQgYWJvdmUgd2UgZGVyaXZlZCB0aGUgZGlzdHJpYnV0aW9uIG9mICREJCB0byBiZSAkTihcbXUgPSAxLCBcc2lnbWFeMiA9IDAuMzIpJAoKSWYgd2UgbG9vayBhdCBhIGhpc3RvZ3JhbSBvZiB0aGUgZGlmZmVyZW5jZXMsIHdlIGZpbmQgdGhhdCBpdCBsb29rcyB2ZXJ5IG11Y2ggbGlrZSBhIG5vcm1hbCBkaXN0cmlidXRpb24uCgpgYGB7cn0KaGlzdChkaWZmZXJlbmNlcywgYnJlYWtzID0gMjAsIAogICAgIG1haW4gICA9ICJFbXBpcmljYWwgRGlzdHJpYnV0aW9uIG9mIEQiLAogICAgIHhsYWIgICA9ICJTaW11bGF0ZWQgVmFsdWVzIG9mIEQiLAogICAgIGNvbCAgICA9ICJkb2RnZXJibHVlIiwKICAgICBib3JkZXIgPSAiZGFya29yYW5nZSIpCmBgYAoKQWxzbyB0aGUgc2FtcGxlIG1lYW4gYW5kIHZhcmlhbmNlIGFyZSB2ZXJ5IGNsb3NlIHRvIHRvIHdoYXQgd2Ugd291bGQgZXhwZWN0LgoKYGBge3J9Cm1lYW4oZGlmZmVyZW5jZXMpCnZhcihkaWZmZXJlbmNlcykKYGBgCgpXZSBjb3VsZCBoYXZlIGFsc28gYWNjb21wbGlzaGVkIHRoaXMgdGFzayB3aXRoIGEgc2luZ2xlIGxpbmUgb2YgbW9yZSAiaWRpb21hdGljIiBgUmAuCgpgYGB7cn0Kc2V0LnNlZWQoNDIpCmRpZmZzID0gcmVwbGljYXRlKDEwMDAwLCBtZWFuKHJub3JtKDI1LCA2LCAyKSkgLSBtZWFuKHJub3JtKDI1LCA1LCAyKSkpCmBgYAoKVXNlIGA/cmVwbGljYXRlYCB0byB0YWtlIGEgbG9vayBhdCB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIGByZXBsaWNhdGVgIGZ1bmN0aW9uIGFuZCBzZWUgaWYgeW91IGNhbiB1bmRlcnN0YW5kIGhvdyB0aGlzIGxpbmUgcGVyZm9ybXMgdGhlIHNhbWUgb3BlcmF0aW9ucyB0aGF0IG91ciBgZm9yYCBsb29wIGFib3ZlIGV4ZWN1dGVkLgoKYGBge3J9Cm1lYW4oZGlmZmVyZW5jZXMgPT0gZGlmZnMpCmBgYAoKV2Ugc2VlIHRoYXQgYnkgc2V0dGluZyB0aGUgc2FtZSBzZWVkIGZvciB0aGUgcmFuZG9taXphdGlvbiwgd2UgYWN0dWFsbHkgb2J0YWluIGlkZW50aWNhbCByZXN1bHRzIQoKIyMjIERpc3RyaWJ1dGlvbiBvZiBhIFNhbXBsZSBNZWFuCgpGb3IgYW5vdGhlciBleGFtcGxlIG9mIHNpbXVsYXRpb24sIHdlIHdpbGwgc2ltdWxhdGUgb2JzZXJ2YXRpb25zIGZyb20gYSBQb2lzc29uIGRpc3RyaWJ1dGlvbiwgYW5kIGV4YW1pbmUgdGhlIGVtcGlyaWNhbCBkaXN0cmlidXRpb24gb2YgdGhlIHNhbXBsZSBtZWFuIG9mIHRoZXNlIG9ic2VydmF0aW9ucy4KClJlY2FsbCwgaWYKClxbClggXHNpbSBQb2lzKFxtdSkKXF0KCnRoZW4KClxbCkVbWF0gPSBcbXUKXF0KCmFuZAoKXFsKVmFyW1hdID0gXG11LgpcXQoKQWxzbywgcmVjYWxsIHRoYXQgZm9yIGEgcmFuZG9tIHZhcmlhYmxlICRYJCB3aXRoIGZpbml0ZSBtZWFuICRcbXUkIGFuZCBmaW5pdGUgdmFyaWFuY2UgJFxzaWdtYV4yJCwgdGhlIGNlbnRyYWwgbGltaXQgdGhlb3JlbSB0ZWxscyB1cyB0aGF0IHRoZSBtZWFuLCAkXGJhcntYfSQgb2YgYSByYW5kb20gc2FtcGxlIG9mIHNpemUgJG4kIGlzIGFwcHJveGltYXRlbHkgbm9ybWFsIGZvciAqbGFyZ2UqIHZhbHVlcyBvZiAkbiQuIFNwZWNpZmljYWxseSwgYXMgJG4gXHRvIFxpbmZ0eSQsCgpcWwpcYmFye1h9IFxvdmVyc2V0e2R9e1x0b30gTlxsZWZ0KFxtdSwgXGZyYWN7XHNpZ21hXjJ9e259XHJpZ2h0KS4KXF0KClRoZSBmb2xsb3dpbmcgdmVyaWZpZXMgdGhpcyByZXN1bHQgZm9yIGEgUG9pc3NvbiBkaXN0cmlidXRpb24gd2l0aCAkXG11ID0gMTAkIGFuZCBhIHNhbXBsZSBzaXplIG9mICRuID0gNTAkLgoKYGBge3J9CnNldC5zZWVkKDEzMzcpCm11ICAgICAgICAgID0gMTAKc2FtcGxlX3NpemUgPSA1MApzYW1wbGVzICAgICA9IDEwMDAwMAp4X2JhcnMgICAgICA9IHJlcCgwLCBzYW1wbGVzKQpgYGAKCmBgYHtyfQpmb3IoaSBpbiAxOnNhbXBsZXMpewogIHhfYmFyc1tpXSA9IG1lYW4ocnBvaXMoc2FtcGxlX3NpemUsIGxhbWJkYSA9IG11KSkKfQpgYGAKCmBgYHtyfQp4X2Jhcl9oaXN0ID0gaGlzdCh4X2JhcnMsIGJyZWFrcyA9IDUwLCAKICAgICAgICAgICAgICAgICAgbWFpbiA9ICJIaXN0b2dyYW0gb2YgU2FtcGxlIE1lYW5zIiwKICAgICAgICAgICAgICAgICAgeGxhYiA9ICJTYW1wbGUgTWVhbnMiKQpgYGAKCk5vdyB3ZSB3aWxsIGNvbXBhcmUgc2FtcGxlIHN0YXRpc3RpY3MgZnJvbSB0aGUgZW1waXJpY2FsIGRpc3RyaWJ1dGlvbiB3aXRoIHRoZWlyIGtub3duIHZhbHVlcyBiYXNlZCBvbiB0aGUgcGFyZW50IGRpc3RyaWJ1dGlvbi4KCmBgYHtyfQpjKG1lYW4oeF9iYXJzKSwgbXUpCmBgYAoKYGBge3J9CmModmFyKHhfYmFycyksIG11IC8gc2FtcGxlX3NpemUpCmBgYAoKYGBge3J9CmMoc2QoeF9iYXJzKSwgc3FydChtdSkgLyBzcXJ0KHNhbXBsZV9zaXplKSkKYGBgCgpBbmQgaGVyZSwgd2Ugd2lsbCBjYWxjdWxhdGUgdGhlIHByb3BvcnRpb24gb2Ygc2FtcGxlIG1lYW5zIHRoYXQgYXJlIHdpdGhpbiAyIHN0YW5kYXJkIGRldmlhdGlvbnMgb2YgdGhlIHBvcHVsYXRpb24gbWVhbi4KCmBgYHtyfQptZWFuKHhfYmFycyA+IG11IC0gMiAqIHNxcnQobXUpIC8gc3FydChzYW1wbGVfc2l6ZSkgJgogICAgIHhfYmFycyA8IG11ICsgMiAqIHNxcnQobXUpIC8gc3FydChzYW1wbGVfc2l6ZSkpCmBgYAoKVGhpcyBsYXN0IGhpc3RvZ3JhbSB1c2VzIGEgYml0IG9mIGEgdHJpY2sgdG8gYXBwcm94aW1hdGVseSBzaGFkZSB0aGUgYmFycyB0aGF0IGFyZSB3aXRoaW4gdHdvIHN0YW5kYXJkIGRldmlhdGlvbnMgb2YgdGhlIG1lYW4uKQoKYGBge3J9CnNoYWRpbmcgPSBpZmVsc2UoeF9iYXJfaGlzdCRicmVha3MgPiBtdSAtIDIgKiBzcXJ0KG11KSAvIHNxcnQoc2FtcGxlX3NpemUpICYgCiAgICAgICAgICAgICAgICAgICB4X2Jhcl9oaXN0JGJyZWFrcyA8IG11ICsgMiAqIHNxcnQobXUpIC8gc3FydChzYW1wbGVfc2l6ZSksCiAgICAgICAgICAgICAgICAgICJkYXJrb3JhbmdlIiwgImRvZGdlcmJsdWUiKQoKeF9iYXJfaGlzdCA9IGhpc3QoeF9iYXJzLCBicmVha3MgPSA1MCwgY29sID0gc2hhZGluZywKICAgICAgICAgICAgICAgICAgbWFpbiA9ICJIaXN0b2dyYW0gb2YgU2FtcGxlIE1lYW5zLCBUd28gU3RhbmRhcmQgRGV2aWF0aW9ucyIsCiAgICAgICAgICAgICAgICAgIHhsYWIgPSAiU2FtcGxlIE1lYW5zIikKYGBgCgoKCgoKYGBge3Iga25pdF9leGl0LCBpbmNsdWRlPUYsIGVjaG89Rn0Ka25pdF9leGl0KCkKYGBg</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("lecture2.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
